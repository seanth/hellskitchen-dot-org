<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Zine Arranger! For PDFs</title>
</head>

<style>
:root {
    --sheet-width: 850px;
    --sheet-height: 1100px;
    
    --sheet-print-width: 8.5in;
    --sheet-print-height: 11in;
    
    --page-width: 425px;
    --page-height: 275px;
    
    --sheet-scale: 1;
}

* {
    image-resolution: 300dpi;
    box-sizing: border-box;
    margin: 0;
    padding: 0;
    background-color: #DDD;
}

p {
    margin: 5px;
    font-family: "Garamond", "Georgia", serif;
}

h1 {
    font-family: "Garamond", "Georgia", serif;
    font-size: 36pt;
    font-weight: bold;
}

button {
    margin: 10px;
    padding: 10px;
    min-width: 85px;
}

input {
    margin: 5px 5px 0px 15px;
}

.num-input {
    background-color: #FFF;
}

.zine-sheet {
    width: var(--sheet-width);
    height: var(--sheet-height);
    display: grid;
    grid-template-areas:
    "tl tr"
    "bl br";
}

.half-por {
    grid-template-areas:
    "tl tr";
}

.half-lnd {
    grid-template-areas:
    "tr"
    "tl";
}

.qtr-side {
    grid-template-areas:
    "tl tr"
    "bl br";
}

.qtr-top {
    grid-template-areas:
    "tl bl"
    "tr br";
}

.eig-por {
    grid-template-areas:
    "tl tml tmr tr"
    "bl bml bmr br";
}

.eig-lnd {
    grid-template-areas:
    "bl tl"
    "bml tml"
    "bmr tmr"
    "br tr";
}

.twlv-por {
    grid-template-areas:
    "g00 g01 g02 g03 g04 g05"
    "g10 g11 g12 g13 g14 g15";
}

.twlv-lnd {
    grid-template-areas:
    "g00 g01"
    "g10 g11"
    "g20 g21"
    "g30 g31"
    "g40 g41"
    "g50 g51";
}

.sxtn-por {
    grid-template-areas:
    "g00 g01 g02 g03"
    "g10 g11 g12 g13"
    "g20 g21 g22 g23"
    "g30 g31 g32 g33";
}

.sxtn-lnd {
    grid-template-areas:
    "g00 g01 g02 g03"
    "g10 g11 g12 g13"
    "g20 g21 g22 g23"
    "g30 g31 g32 g33";
}
    
.twfr-por {
    grid-template-areas:
    "g00 g01 g02 g03 g04 g05"
    "g10 g11 g12 g13 g14 g15"
    "g20 g21 g22 g23 g24 g25"
    "g30 g31 g32 g33 g34 g35"
}

.twfr-lnd {
    grid-template-areas:
    "g00 g01 g02 g03"
    "g10 g11 g12 g13"
    "g20 g21 g22 g23"
    "g30 g31 g32 g33"
    "g40 g41 g42 g43"
    "g50 g51 g52 g53"
}

.thtw-por {
    grid-template-areas:
    "g00 g01 g02 g03 g04 g05 g06 g07"
    "g10 g11 g12 g13 g14 g15 g16 g17"
    "g20 g21 g22 g23 g24 g25 g26 g27"
    "g30 g31 g32 g33 g34 g35 g36 g37"
}

.thtw-lnd {
    grid-template-areas:
    "g00 g01 g02 g03"
    "g10 g11 g12 g13"
    "g20 g21 g22 g23"
    "g30 g31 g32 g33"
    "g40 g41 g42 g43"
    "g50 g51 g52 g53"
    "g60 g61 g62 g63"
    "g70 g71 g72 g73"
}

.thsx-por {
    grid-template-areas:
    "g00 g01 g02 g03 g04 g05"
    "g10 g11 g12 g13 g14 g15"
    "g20 g21 g22 g23 g24 g25"
    "g30 g31 g32 g33 g34 g35"
    "g40 g41 g42 g43 g44 g45"
    "g50 g51 g52 g53 g54 g55"
}

.thsx-lnd {
    grid-template-areas:
    "g00 g01 g02 g03 g04 g05"
    "g10 g11 g12 g13 g14 g15"
    "g20 g21 g22 g23 g24 g25"
    "g30 g31 g32 g33 g34 g35"
    "g40 g41 g42 g43 g44 g45"
    "g50 g51 g52 g53 g54 g55"
}

.frei-por {
    grid-template-areas:
    "g00 g01 g02 g03 g04 g05 g06 g07"
    "g10 g11 g12 g13 g14 g15 g16 g17"
    "g20 g21 g22 g23 g24 g25 g26 g27"
    "g30 g31 g32 g33 g34 g35 g36 g37"
    "g40 g41 g42 g43 g44 g45 g46 g47"
    "g50 g51 g52 g53 g54 g55 g56 g57"
}

.frei-lnd {
    grid-template-areas:
    "g00 g01 g02 g03 g04 g05"
    "g10 g11 g12 g13 g14 g15"
    "g20 g21 g22 g23 g24 g25"
    "g30 g31 g32 g33 g34 g35"
    "g40 g41 g42 g43 g44 g45"
    "g50 g51 g52 g53 g54 g55"
    "g60 g61 g62 g63 g64 g65"
    "g70 g71 g72 g73 g74 g75"
}

.sxfr-por {
    grid-template-areas:
    "g00 g01 g02 g03 g04 g05 g06 g07"
    "g10 g11 g12 g13 g14 g15 g16 g17"
    "g20 g21 g22 g23 g24 g25 g26 g27"
    "g30 g31 g32 g33 g34 g35 g36 g37"
    "g40 g41 g42 g43 g44 g45 g46 g47"
    "g50 g51 g52 g53 g54 g55 g56 g57"
    "g60 g61 g62 g63 g64 g65 g66 g67"
    "g70 g71 g72 g73 g74 g75 g76 g77"
}

.sxfr-lnd {
    grid-template-areas:
    "g00 g01 g02 g03 g04 g05 g06 g07"
    "g10 g11 g12 g13 g14 g15 g16 g17"
    "g20 g21 g22 g23 g24 g25 g26 g27"
    "g30 g31 g32 g33 g34 g35 g36 g37"
    "g40 g41 g42 g43 g44 g45 g46 g47"
    "g50 g51 g52 g53 g54 g55 g56 g57"
    "g60 g61 g62 g63 g64 g65 g66 g67"
    "g70 g71 g72 g73 g74 g75 g76 g77"
}

.zine-page {
    width: var(--page-width);
    height: var(--page-height);
    padding: .2rem;
    overflow: hidden;
    display: flex;
    align-items: center;
    justify-content: space-around;
    flex: 1;
}

/*.zine-canvas {
    flex: 1;
}*/

.tl {
    grid-area: tl;
}

.tr {
    grid-area: tr;
}

.bl {
    grid-area: bl;
}

.br {
    grid-area: br;
}

.tml {
    grid-area: tml;
}

.tmr {
    grid-area: tmr;
}

.bml {
    grid-area: bml;
}

.bmr {
    grid-area: bmr;
}

.g00 {
    grid-area: g00;
}

.g01 {
    grid-area: g01;
}

.g02 {
    grid-area: g02;
}

.g03 {
    grid-area: g03;
}

.g04 {
    grid-area: g04;
}

.g05 {
    grid-area: g05;
}

.g06 {
    grid-area: g06;
}

.g07 {
    grid-area: g07;
}

.g10 {
    grid-area: g10;
}

.g11 {
    grid-area: g11;
}

.g12 {
    grid-area: g12;
}

.g13 {
    grid-area: g13;
}

.g14 {
    grid-area: g14;
}

.g15 {
    grid-area: g15;
}

.g16 {
    grid-area: g16;
}

.g17 {
    grid-area: g17;
}

.g20 {
    grid-area: g20;
}

.g21 {
    grid-area: g21;
}

.g22 {
    grid-area: g22;
}

.g23 {
    grid-area: g23;
}

.g24 {
    grid-area: g24;
}

.g25 {
    grid-area: g25;
}

.g26 {
    grid-area: g26;
}

.g27 {
    grid-area: g27;
}

.g30 {
    grid-area: g30;
}

.g31 {
    grid-area: g31;
}

.g32 {
    grid-area: g32;
}

.g33 {
    grid-area: g33;
}

.g34 {
    grid-area: g34;
}

.g35 {
    grid-area: g35;
}

.g36 {
    grid-area: g36;
}

.g37 {
    grid-area: g37;
}

.g40 {
    grid-area: g40;
}

.g41 {
    grid-area: g41;
}

.g42 {
    grid-area: g42;
}

.g43 {
    grid-area: g43;
}

.g44 {
    grid-area: g44;
}

.g45 {
    grid-area: g45;
}

.g46 {
    grid-area: g46;
}

.g47 {
    grid-area: g47;
}

.g50 {
    grid-area: g50;
}

.g51 {
    grid-area: g51;
}

.g52 {
    grid-area: g52;
}

.g53 {
    grid-area: g53;
}

.g54 {
    grid-area: g54;
}

.g55 {
    grid-area: g55;
}

.g56 {
    grid-area: g56;
}

.g57 {
    grid-area: g57;
}

.g60 {
    grid-area: g60;
}

.g61 {
    grid-area: g61;
}

.g62 {
    grid-area: g62;
}

.g63 {
    grid-area: g63;
}

.g64 {
    grid-area: g64;
}

.g65 {
    grid-area: g65;
}

.g66 {
    grid-area: g66;
}

.g67 {
    grid-area: g67;
}

.g70 {
    grid-area: g70;
}

.g71 {
    grid-area: g71;
}

.g72 {
    grid-area: g72;
}

.g73 {
    grid-area: g73;
}

.g74 {
    grid-area: g74;
}

.g75 {
    grid-area: g75;
}

.g76 {
    grid-area: g76;
}

.g77 {
    grid-area: g77;
}

.rotate {
    transform: rotate(180deg);
}

.guide-margins {
    border: 6px solid black;
    /*outline: 8px solid black;*/
}

.guide-solid-bottom {
    border-bottom: 3px solid black;
}

.guide-solid-left {
    border-left: 3px solid black;
}

.guide-solid-top {
    border-top: 3px solid black;
}

.guide-solid-right {
    border-right: 3px solid black;
}

.guide-dotted-bottom {
    border-bottom: 2px dotted black;
}

.guide-dotted-left {
    border-left: 2px dotted black;
}

.guide-dotted-top {
    border-top: 2px dotted black;
}

.guide-dotted-right {
    border-right: 2px dotted black;
}

@media screen {
    .zine {
        display: block;
        transform: scale(var(--sheet-scale));
        transform-origin: top left;
    }
    
    .zine-sheet {
        margin: 48px;
        outline: 6px solid black;
    }

    .header {
        margin: 12px 0px 0px 0px;
        width: 100vw;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: space-around;
    }
    
    .header-item {
        width: 90%;
        margin: 8px;
        display: flex;
        flex-direction: row;
        align-items: left;
    }
}

@media print {
    @page {
        margin: 0;
        bleed: 0;
    }
    
    .zine-sheet {
        /*width: 100vw;
        height: 100vh;*/
        width: var(--sheet-print-width);
        height: var(--sheet-print-height);
        /*float: left;*/
        /*gap: 1.5px;*/
        break-after: always;
        break-inside: avoid;
        /*border: 4px dashed black;*/
    }
    
    .guide-margins {
        width: 100%;
        height: 100%;
    }
    
    .noprint {
        display: none;
    }
}
</style>

<style id="page-orient-style">
</style>


<script src="./pdfjs/build/pdf.js"></script>

<section class="header noprint">
    <section class="header">
        <header><h1>Zine Arranger!</h1></header>
        <p>Convert a multi-page PDF into a zine!</p>
        <p id="lbl-pc-mult">To avoid blank pages at the end, the page count should be a multiple of 8.</p>
        <p id="folding-ins"></p>
    </section>
    <section class="header-item">
        <p>Choose the PDF:</p>
        <input type="file" id="selector"></input>
    </section>
    <section class="header-item">
        <p>Once you've got your PDF, click the Print button to print or save it! (Choose "Save as PDF" or "Print to File" to save the zine.)</p>
        <button onclick="window.print()">Print</button>
    </section>
    <section class="header-item" id="options">
        <section id="opt-zinesize">
            <p>Zine Size</p>
            <input type="radio" id="zs-half" name="zsize" checked="true" onchange="selectHalfSize()"></input>
            <label for="zs-half">Half Size</label><br>
            <input type="radio" id="zs-qtr" name="zsize" onchange="selectQuarterSize()"></input>
            <label for="zs-qtr">Quarter Size</label><br>
            <input type="radio" id="zs-eighth" name="zsize" onchange="selectEighthSize()"></input>
            <label for="zs-eighth">Eighth Size (Minizine)</label><br>
            <div id="extra-sizes" style="display:none;">
                <input type="radio" id="zs-twlv" name="zsize" onchange="select12thSize()"></input>
                <label for="zs-twlv">1/12th Size</label><br>
                <input type="radio" id="zs-sxtn" name="zsize" onchange="select16thSize()"></input>
                <label for="zs-sxtn">1/16th Size (Micro-Mini)</label><br>
                <input type="radio" id="zs-twfr" name="zsize" onchange="select24thSize()"></input>
                <label for="zs-twfr">1/24th Size</label><br>
                <input type="radio" id="zs-thtw" name="zsize" onchange="select32ndSize()"></input>
                <label for="zs-thtw">1/32nd Size</label><br>
                <input type="radio" id="zs-thsx" name="zsize" onchange="select36thSize()"></input>
                <label for="zs-thsx">1/36th Size</label><br>
                <input type="radio" id="zs-frei" name="zsize" onchange="select48thSize()"></input>
                <label for="zs-frei">1/48th Size</label><br>
                <input type="radio" id="zs-sxfr" name="zsize" onchange="select64thSize()"></input>
                <label for="zs-sxfr">1/64th Size</label><br>
            </div>
            <button id="extra-sizes-button" onclick="toggleMoreSizes()">More Sizes</button>
        </section>
        <section id="show-more-options" onclick="toggleAdvancedOptions()">
            <input type="checkbox" id="show-more"></input>
            <label for="show-more">Show Advanced Options</label>
        </section>
    </section>
    <section id="advanced-options-a" class="header-item" style="display:none;">
        <section id="opt-duplex">
            <p>Print on:</p>
            <input type="radio" id="dx-double" name="duplex" onchange="refreshSpecs()"></input>
            <label for="dx-double">Both Sides</label><br>
            <input type="radio" id="dx-single" name="duplex" checked="true" onchange="refreshSpecs()"></input>
            <label for="dx-single">One Side</label><br>
        </section>
        <section id="opt-orient">
            <p>Zine Orientation:</p>
            <input type="radio" id="ori-portrait" name="paper-orient" checked="true" onchange="refreshSpecs()"></input>
            <label for="ori-portrait">Portrait</label><br>
            <input type="radio" id="ori-landscape" name="paper-orient" onchange="refreshSpecs()"></input>
            <label for="ori-landscape">Landscape</label><br>
        </section>
        <section id="opt-spine">
            <p>Booklet spine:</p>
            <input type="radio" id="spine-side" name="spine-orient" checked="true" onchange="refreshSpecs()"></input>
            <label for="spine-side">Side</label><br>
            <input type="radio" id="spine-top" name="spine-orient" onchange="refreshSpecs()"></input>
            <label for="spine-top">Top</label><br>
            <input type="checkbox" id="flip-bc" onchange="refreshSpecs()"></input>
            <label id="flip-bc-label" for="flip-bc">Flip Back Cover (for Top-Fold Zines)</label>
        </section>
    </section>
    <section id="advanced-options-b" class="header-item" style="display:none;">
        <div style="flex-direction: rows;">
            <section id="opt-extras">
                <input type="checkbox" id="quarter-copy" name="quarter-copy" onchange="refreshSpecs()"></input>
                <label for="quarter-copy">Two Copies per sheet (Quarter Sized)</label>
            </section>
            <section id="opt-signatures">
                <p>Binding Style:</p>
                <input type="checkbox" id="cust-sig-size" onchange="refreshSpecs()"></input>
                <label id="cust-sig-size-label" for="cust-sig-size">Custom Signature Size</label><br>
                <input type="number" class="num-input" id="sig-size" min="0" value="0" onchange="refreshSpecs()" style="display:none"></input>
                <label id="sig-size-label" for="signt-size" style="display:none">Sheets per signature</label>
            </section>
            <section id="opt-guides">
                <p>Cutting Guides:</p>
                <input type="checkbox" id="guide-margin" name="guide-margin" onchange="refreshSpecs()"></input>
                <label for="guide-margin">Margins</label>
                <input type="checkbox" id="guide-center" name="guide-center" onchange="refreshSpecs()"></input>
                <label for="guide-middle">Center</label>
                <input type="checkbox" id="guide-folds" name="guide-folds" onchange="refreshSpecs()"></input>
                <label for="guide-folds">Folds</label>
            </section>
            <section id="opt-ratio">
                <p>Paper Size</p>
                <input type="number" class="num-input" id="rt-width" min="0.25" max="1100" value="8.5" onchange="refreshSpecs()"></input>
                <label id="rt-width-label" for="rt-width">Width</label><br>
                <input type="number" class="num-input" id="rt-height" min="0.25" max="1100" value="11" onchange="refreshSpecs()"></input>
                <label id="rt-height-label" for="rt-height">Height</label><br><input type="radio" id="page-inches" name="page-unit" checked="true" onchange="refreshSpecs()"></input>
                <label for="page-inches">Inches</label><br>
                <input type="radio" id="page-mm" name="page-unit" onchange="refreshSpecs()"></input>
                <label for="page-mm">Millimeters</label>
            </section>
            <section id="opt-page-presets">
                <div style="display:flex;flex-direction:columns">
                    <button id="page-us-letter" onclick="setPageUSLetter()">US Letter</button><br>
                    <button id="page-11-17" onclick="setPage11_17()">11"x17"</button><br>
                </div>
                <div style="display:flex;flex-direction:columns">
                    <button id="page-a4" onclick="setPageA4()">A4</button><br>
                    <button id="page-a3" onclick="setPageA3()">A3</button><br>
                </div>
            </section>
        </div>
    </section>
    <section class="header-item">
        <p></p>
    </section>

</section>
<section class="zine" id="zine" style="display:none">
</section>


<script>
    const SIZE_HALF = 0;
    const SIZE_QUARTER = 1;
    const SIZE_EIGHTH = 2;
    const SIZE_12TH = 3;
    const SIZE_16TH = 4;
    const SIZE_24TH = 5;
    const SIZE_32ND = 6;
    const SIZE_36TH = 7;
    const SIZE_48TH = 8;
    const SIZE_64TH = 9;
    
    const SIZE_CHARS = ["2-","4-","8-","12-","16-","24-","32-","36-","48-","64-"]
    
    var size = SIZE_EIGHTH;
     
    var doubleSided = false; // whether we are printing double-sided
    var zinePortrait = true; // whether the zine is portrait orientation (false=landscape)
    var spineSide = true; // whether the spine is on the side of the zine (false=top spine)
    
    var flipBackCover = true; // whether to flip the back cover on top fold zines (false = cover is right-side up from outside; true = cover right side up when viewed as last page)
    var quarterCopy = false; // whether each sheet of a quarter-sized zine should have two copies instead of two different sheets of pages
    
    var guideMargins = false; // whether to display a guide line around the margins
    var guideCenter = false; // whether to display a guide line along the center cut section (for quarter sized & 8-page mini)
    var guideFolds = false; // whether to display guide lines along folds
    
    var pagePortrait = false; // whether the printed page is portrait orientation (calculated based on above values)

    var aspectWidth = 11;
    var aspectHeight = 8.5;
    var divHoriz = 4; // number of horizontal pages per sheet
    var divVert = 2; // number of vertical pages per sheet
    var pagerat = 5.5/4.25;
    var pgmult = 8; // number of zine pages on a full sheet
    var sheetWidth = 1100;
    var sheetHeight = 850;
    var pageWidth = 275;
    var pageHeight = 425;
    var pageCount = 0;
    
    var sigSize = -1; // the size of each signature, in full sheets of paper. -1 will make the whole zine in one signature
    
    var specsString = "8-1ps";
    
    var pgunit = "in";
    
    var showExtraSizes = false;
    
    function toggleAdvancedOptions() {
        if(document.getElementById("show-more").checked) {
            document.getElementById("advanced-options-a").style.display = "flex";
            document.getElementById("advanced-options-b").style.display = "flex";
        } else {
            document.getElementById("advanced-options-a").style.display = "none";
            document.getElementById("advanced-options-b").style.display = "none";
        }
    }
    
    function toggleMoreSizes() {
        if(showExtraSizes) {
            document.getElementById("extra-sizes").style.display = "none";
            document.getElementById("extra-sizes-button").innerHTML = "More Sizes";
            showExtraSizes = false;
        } else {
            document.getElementById("extra-sizes").style.display = "inline";
            document.getElementById("extra-sizes-button").innerHTML = "Fewer Sizes";
            showExtraSizes = true;
        }
    }
    
    function selectEighthSize() {
        document.getElementById("dx-single").checked = true;
        document.getElementById("ori-portrait").checked = true;
        document.getElementById("spine-side").checked = true;
        refreshSpecs();
    }
    
    function selectQuarterSize() {
        document.getElementById("dx-double").checked = true;
        document.getElementById("ori-portrait").checked = true;
        document.getElementById("spine-side").checked = true;
        refreshSpecs();
    }
    
    function selectHalfSize() {
        document.getElementById("dx-double").checked = true;
        document.getElementById("spine-side").checked = document.getElementById("ori-portrait").checked;
        refreshSpecs();
    }
    
    function select12thSize() {
        document.getElementById("dx-single").checked = true;
        document.getElementById("ori-portrait").checked = true;
        document.getElementById("spine-side").checked = true;
        refreshSpecs();
    }
    
    function select16thSize() {
        document.getElementById("dx-single").checked = true;
        document.getElementById("ori-portrait").checked = true;
        document.getElementById("spine-side").checked = true;
        refreshSpecs();
    }
    
    function select24thSize() {
        document.getElementById("dx-single").checked = true;
        document.getElementById("ori-portrait").checked = true;
        document.getElementById("spine-side").checked = true;
        refreshSpecs();
    }
    
    function select32ndSize() {
        document.getElementById("dx-single").checked = true;
        document.getElementById("ori-portrait").checked = true;
        document.getElementById("spine-side").checked = true;
        refreshSpecs();
    }
    
    function select36thSize() {
        document.getElementById("dx-single").checked = true;
        document.getElementById("ori-portrait").checked = true;
        document.getElementById("spine-side").checked = true;
        refreshSpecs();
    }
    
    function select48thSize() {
        document.getElementById("dx-single").checked = true;
        document.getElementById("ori-portrait").checked = true;
        document.getElementById("spine-side").checked = true;
        refreshSpecs();
    }
    
    function select64thSize() {
        document.getElementById("dx-single").checked = true;
        document.getElementById("ori-portrait").checked = true;
        document.getElementById("spine-side").checked = true;
        refreshSpecs();
    }
    
    function setPageUSLetter() {
        document.getElementById("page-inches").checked = true;
        document.getElementById("rt-width").value = "8.5";
        document.getElementById("rt-height").value = "11";
        refreshSpecs();
    }

    function setPage11_17() {
        document.getElementById("page-inches").checked = true;
        document.getElementById("rt-width").value = "11";
        document.getElementById("rt-height").value = "17";
        refreshSpecs();
    }
    
    function setPageA4() {
        document.getElementById("page-mm").checked = true;
        document.getElementById("rt-width").value = "210";
        document.getElementById("rt-height").value = "297";
        refreshSpecs();
    }

    function setPageA3() {
        document.getElementById("page-mm").checked = true;
        document.getElementById("rt-width").value = "297";
        document.getElementById("rt-height").value = "420";
        refreshSpecs();
    }
    
    // refreshes all parameters
    function refreshSpecs() {
        // poll main layout options
        if(document.getElementById("zs-half").checked) {
            size = SIZE_HALF;
        } else if(document.getElementById("zs-qtr").checked) {
            size = SIZE_QUARTER;
        } else if(document.getElementById("zs-eighth").checked) {
            size = SIZE_EIGHTH;
        } else if(document.getElementById("zs-twlv").checked) {
            size = SIZE_12TH;
        } else if(document.getElementById("zs-sxtn").checked) {
            size = SIZE_16TH;
        } else if(document.getElementById("zs-twfr").checked) {
            size = SIZE_24TH;
        } else if(document.getElementById("zs-thtw").checked) {
            size = SIZE_32ND;
        } else if(document.getElementById("zs-thsx").checked) {
            size = SIZE_36TH;
        } else if(document.getElementById("zs-frei").checked) {
            size = SIZE_48TH;
        } else if(document.getElementById("zs-sxfr").checked) {
            size = SIZE_64TH;
        }
        
        doubleSided = document.getElementById("dx-double").checked;
        zinePortrait = document.getElementById("ori-portrait").checked;
        spineSide = document.getElementById("spine-side").checked;
        flipBackCover = document.getElementById("flip-bc").checked;
        quarterCopy = document.getElementById("quarter-copy").checked;
        
        if(document.getElementById("cust-sig-size").checked) {
            document.getElementById("sig-size").style = "display:inline";
            document.getElementById("sig-size-label").style = "display:inline";
            sigSize = document.getElementById("sig-size").value;
        } else {
            document.getElementById("sig-size").style = "display:none";
            document.getElementById("sig-size-label").style = "display:none";
            sigSize = 0;
        }
        
        guideMargins = document.getElementById("guide-margin").checked;
        guideCenter = document.getElementById("guide-center").checked;
        guideFolds = document.getElementById("guide-folds").checked;
        
        specsString = SIZE_CHARS[size];
        
        if(doubleSided) {
            specsString = specsString + "2";
        } else {
            specsString = specsString + "1";
        }
        
        if(zinePortrait) {
            specsString = specsString + "p";
        } else {
            specsString = specsString + "l";
        }
        
        if(spineSide) {
            specsString = specsString + "s";
        } else {
            specsString = specsString + "t";
        }
        document.getElementById("folding-ins").innerHTML = "<a href=\"folding.html?" + specsString + "\">Folding Instructions</a>";
        
        pgmult = 0
        
        
        // set the number of zine pages per sheet and the paper orientation (based on zine size & zine orientation)
        switch(size) {
            case SIZE_HALF:
                pgmult = 4;
                pagePortrait = !zinePortrait;
                if(zinePortrait) {
                    divVert = 1;
                    divHoriz = 2;
                } else {
                    divVert = 2;
                    divHoriz = 1;
                }
                break;
            case SIZE_QUARTER:
                if(doubleSided) {
                    if(quarterCopy) {
                        pgmult = 4;
                    } else {
                        pgmult = 8;
                    }
                } else {
                    pgmult = 4;
                }
                divVert = 2;
                divHoriz = 2;
                pagePortrait = zinePortrait;
                break;
            case SIZE_EIGHTH:
                if(doubleSided) {
                    pgmult = 16;
                } else {
                    pgmult = 8;
                }
                if(zinePortrait) {
                    divVert = 2;
                    divHoriz = 4;
                } else {
                    divVert = 4;
                    divHoriz = 2;
                }
                pagePortrait = !zinePortrait;
                break;
            case SIZE_12TH:
                if(doubleSided) {
                    pgmult = 24;
                } else {
                    pgmult = 12;
                }
                if(zinePortrait) {
                    divVert = 2
                    divHoriz = 6;
                } else {
                    divVert = 6;
                    divHoriz = 2;
                }
                pagePortrait = !zinePortrait;
                break;
            case SIZE_16TH:
                if(doubleSided) {
                    pgmult = 32;
                } else {
                    pgmult = 16;
                }
                divVert = 4;
                divHoriz = 4;
                pagePortrait = zinePortrait;
                break;
            case SIZE_24TH:
                if(doubleSided) {
                    pgmult = 48;
                } else {
                    pgmult = 24;
                }
                if(zinePortrait) {
                    divVert = 4;
                    divHoriz = 6;
                } else {
                    divVert = 6;
                    divHoriz = 4;
                }
                pagePortrait = !zinePortrait;
                break;
            case SIZE_32ND:
                if(doubleSided) {
                    pgmult = 64;
                } else {
                    pgmult = 32;
                }
                if(zinePortrait) {
                    divVert = 4;
                    divHoriz = 8;
                } else {
                    divVert = 8;
                    divHoriz = 4;
                }
                pagePortrait = !zinePortrait;
                break;
            case SIZE_36TH:
                if(doubleSided) {
                    pgmult = 72;
                } else {
                    pgmult = 36;
                }
                divVert = 6;
                divHoriz = 6;
                pagePortrait = zinePortrait;
                break;
            case SIZE_48TH:
                if(doubleSided) {
                    pgmult = 96;
                } else {
                    pgmult = 48;
                }
                if(zinePortrait) {
                    divVert = 6;
                    divHoriz = 8;
                } else {
                    divVert = 8;
                    divHoriz = 6;
                }
                pagePortrait = !zinePortrait;
                break;
            case SIZE_64TH:
                if(doubleSided) {
                    pgmult = 128;
                } else {
                    pgmult = 64;
                }
                divVert = 8;
                divHoriz = 8;
                pagePortrait = zinePortrait;
            default: // this better not happen!!!
                break;
        }
        
        document.getElementById("lbl-pc-mult").innerHTML = "To avoid blank pages at the end, the page count should be a multiple of " + pgmult + ".";
        document.getElementById("sig-size-label").innerHTML = "Sheets per signature (" + (pgmult * sigSize) + " zine pages/signature)";
        
        // update aspect ratio labels & poll aspect ratio values
        // this is based on the paper orientation
        if(pagePortrait) {
            document.getElementById("rt-width-label").innerHTML = "Width";
            document.getElementById("rt-height-label").innerHTML = "Height";
            
            aspectWidth = document.getElementById("rt-width").value;
            aspectHeight = document.getElementById("rt-height").value;
        } else {
            document.getElementById("rt-width-label").innerHTML = "Height";
            document.getElementById("rt-height-label").innerHTML = "Width";
            
            aspectWidth = document.getElementById("rt-height").value;
            aspectHeight = document.getElementById("rt-width").value;
        }
        
        // calculate the zine page aspect ratio
        pagerat = (aspectWidth / divHoriz) / (aspectHeight / divVert);
    
        // update the CSS dimensions
        var scl = aspectWidth;
        if(scl == 0) {
            scl = 1;
        }
        while(scl < 1000) {
            scl *= 2;
        }
        var scl = scl / aspectWidth; // frame width is 574; this is 550 x2 (will be scaled by 0.5 in CSS)
        scl = Math.floor(scl,1);
        
        sheetWidth = scl*aspectWidth;
        sheetHeight = scl*aspectHeight;
        
        
        pgunit = "in";
        
        if(document.getElementById("page-mm").checked) {
            pgunit = "mm";
        }
        
        pageWidth = Math.floor(sheetWidth / divHoriz);
        pageHeight = Math.floor(sheetHeight / divVert);
        
        
        var rt = document.querySelector(':root');
        rt.style.setProperty('--sheet-width', sheetWidth + "px");
        rt.style.setProperty('--sheet-height', sheetHeight + "px");
        rt.style.setProperty('--sheet-print-width', aspectWidth + pgunit);
        rt.style.setProperty('--sheet-print-height', aspectHeight + pgunit);
        rt.style.setProperty('--page-width', pageWidth + "px");
        rt.style.setProperty('--page-height', pageHeight + "px");
        rt.style.setProperty('--sheet-scale', (550 / sheetWidth));
        
        selectFile(); // refresh the PDF if one has already been selected
    }
    
    function selectFile() {
        if(document.getElementById("selector").files.length > 0) {
            document.getElementById("zine").innerHTML = ""; // clear out existing zine field to prevent weirdness hopefully
            document.getElementById("zine").style.display = "block";
            var fl = document.getElementById("selector").files[0];
            var nms = fl.name.split(".");
            if(nms.length > 1) {
                document.title = nms[0] + "-Printable." + nms[1];
            } else {
                document.title = fl.name + "-Printable.pdf";
            }
            var url = URL.createObjectURL(fl);
            
            const loadingTask = pdfjsLib.getDocument(url);
            (async () => {
                const pdf = await loadingTask.promise;
                
                var actualPageCount = pdf.numPages;
                // We'll do some special handling for double-sided zines when their page count is a multiple of 4 but not a multiple of the full sheet count.
                // Single sided zines get blank pages at the end, which is easy, but for this situation, we want to put them directly in the middle
                // That way the blank pages will all be at the bottom of the sheet/sheets & can be discarded after printing.
                var needsMidBump = (doubleSided && actualPageCount%4 == 0 && actualPageCount % pgmult != 0); // whether we need to do special blank page handling
                var midBumper = 0; // if we need to insert blank pages into the middle, this will 'bump' the page count up by the blank page count part way through
                pageCount = actualPageCount;
                arrangeZineSheets(); // this will increase pageCount to a multiple of pgmult
                var blankPages = pageCount - actualPageCount;
                //
                // Fetch the first page
                //
                for(var i = 1; i<actualPageCount+1; i++) {
                    const page = await pdf.getPage(i);
                    var viewport = page.getViewport({ scale: 1 });
                    var scale;
                    //console.log("VPW: " + viewport.width + " || VPH: " + viewport.height + " || pagrat: " + pagerat + " || pageWidth: " + pageWidth + " || pageHeight: " + pageHeight);
                    if(viewport.width / viewport.height >= pagerat) {
                        scale = pageWidth / viewport.width;
                    } else {
                        scale = pageHeight / viewport.height;
                    }
                    //const scale = 72 / 4 * 11 / viewport.width;
                    viewport = page.getViewport({ scale: scale });
                    
                    const outputScale = 3;

                    // for double-sided zines with inserted blank pages
                    if(needsMidBump && i == ((pageCount-blankPages)/2+1)) {
                        midBumper = blankPages;
                    }
                    //
                    // Prepare canvas using PDF page dimensions
                    //
                    const canvas = document.getElementById("p" + (i-1+midBumper));
                    const context = canvas.getContext("2d");

                    canvas.width = Math.floor(viewport.width * outputScale);
                    canvas.height = Math.floor(viewport.height * outputScale);
                    canvas.style.width = Math.floor(viewport.width) + "px";
                    canvas.style.height = Math.floor(viewport.height) + "px";

                    const transform = outputScale !== 1
                      ? [outputScale, 0, 0, outputScale, 0, 0] 
                      : null;

                    //
                    // Render PDF page into canvas context
                    //
                    const renderContext = {
                      canvasContext: context,
                      transform,
                      viewport,
                      /*background: 'rgba(0,0,0,0)',*/
                    };
                    const renderTask = page.render(renderContext);
                    
                    // If we are doing Quarter-Sized copy mode, prepare canvases for pXb pages
                    if(size == SIZE_QUARTER && quarterCopy) {
                        const ready = await renderTask.promise;
                        
                        const pageB = await pdf.getPage(i);
                        var viewportB = page.getViewport({ scale: scale });
                        
                        //
                        // Prepare canvas using PDF page dimensions
                        //
                        const canvasB = document.getElementById("p" + (i-1) + "b");
                        const contextB = canvasB.getContext("2d");

                        canvasB.width = Math.floor(viewportB.width * outputScale);
                        canvasB.height = Math.floor(viewportB.height * outputScale);
                        canvasB.style.width = Math.floor(viewport.width) + "px";
                        canvasB.style.height = Math.floor(viewport.height) + "px";

                        //
                        // Render PDF page into canvas context
                        //
                        const renderContextB = {
                          canvasContext: contextB,
                          transform,
                          viewport,
                        };
                        page.render(renderContextB);
                    }
                }
          })();
        }
    }
    
    function arrangeZineSheets() {
        // clear the existing zine contents
        document.getElementById("zine").innerHTML = "";
        var sheetsHTML = "";
        
        // compile the grid array
        var gridType = "";
        var marginGuides = "";
        if(guideMargins) {
            marginGuides = " guide-margins";
        }

        var foldLeft = "";
        var foldBottom = "";
        var foldTop = "";
        var foldRight = "";
        
        var cutLeft = "";
        var cutBottom = "";
        var cutTop = "";
        var cutRight = "";
        
        if(guideCenter) {
            cutLeft = " guide-solid-left";
            cutBottom = " guide-solid-bottom";
            cutRight = " guide-solid-right";
            cutTop = " guide-solid-top";
        } else if(guideFolds) {
            cutLeft = " guide-dotted-left";
            cutBottom = " guide-dotted-bottom";
            cutTop = " guide-dotted-top";
            cutRight = " guide-dotted-right";
        }
        
        if(guideFolds) {
            foldLeft = " guide-dotted-left";
            foldBottom = " guide-dotted-bottom";
            foldTop = " guide-dotted-top";
            foldRight = " guide-dotted-right";
        }
        
        var rt = " rotate";
        
        var pagesPerSheet = 4; // zine pages per sheet of paper
        var sheetsPerSig = sigSize; // sheets of paper per signature
        var pagesPerSig = 0 // zine pages per signature (to be initialized later)
        
        if(size == SIZE_HALF) {    // HALF SIZE (PORTRAIT & LANDSCAPE ONLY)
            if(pageCount % 4 != 0) {
                pageCount += 4-(pageCount%4);
            }
            
            pagesPerSheet = 4;
            if(sheetsPerSig <= 0) {
                sheetsPerSig = pageCount / pagesPerSheet;
            }
            pagesPerSig = sheetsPerSig * pagesPerSheet;
            
            if(zinePortrait) {
                setPageOrientation(false);
                gridType = "half-por";
                
                for(let i = 0; i < pageCount / 4; i++) {
                    var sigCount = Math.floor(i / sheetsPerSig);
                    var s = 2*(i%sheetsPerSig) + (sigCount*pagesPerSig);
                    var e = (sigCount+1)*pagesPerSig - (2*(i%sheetsPerSig)) - 1;
                    
                    sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                    sheetsHTML = sheetsHTML + "<section class=\"zine-page tl" + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                    sheetsHTML = sheetsHTML + "<section class=\"zine-page tr" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                    sheetsHTML = sheetsHTML + "</section>";
                    
                    sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2+1) + "\">";
                    sheetsHTML = sheetsHTML + "<section class=\"zine-page tl" + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                    sheetsHTML = sheetsHTML + "<section class=\"zine-page tr" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                    sheetsHTML = sheetsHTML + "</section>";                 
                }
            } else {
                setPageOrientation(true);
                gridType = "half-lnd";
                
                for(let i = 0; i < pageCount / 4; i++) {
                    var sigCount = Math.floor(i / sheetsPerSig);
                    var s = 2*(i%sheetsPerSig) + (sigCount*pagesPerSig);
                    var e = (sigCount+1)*pagesPerSig - (2*(i%sheetsPerSig)) - 1;
                    
                    sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                    sheetsHTML = sheetsHTML + "<section class=\"zine-page tl" + "\"><canvas class=\"zine-canvas\" id=\"p" + s + "\"></canvas></section>";
                    if(!flipBackCover && e == pageCount-1) {
                        sheetsHTML = sheetsHTML + "<section class=\"zine-page tr" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + e + "\"></canvas></section>";
                    } else {
                        sheetsHTML = sheetsHTML + "<section class=\"zine-page tr" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + e + "\"></canvas></section>";
                    }
                    sheetsHTML = sheetsHTML + "</section>";
                    
                    sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2+1) + "\">";
                    sheetsHTML = sheetsHTML + "<section class=\"zine-page tl" + rt + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>"; 
                    sheetsHTML = sheetsHTML + "<section class=\"zine-page tr" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                    sheetsHTML = sheetsHTML + "</section>";
                }
            }
        } else if (size == SIZE_QUARTER) { // quarter size
            /*if(spineSide) {
                gridType = "qtr-side"; // grid for quarter-sized side fold
            } else {
                gridType = "qtr-top"; // grid for quarter-sized top fold
            }*/
            gridType = "qtr-side"; // just doing the default grid cause we'll rearrange in each block now
            
            if(doubleSided) { // QUARTER DOUBLE
                if(quarterCopy) { // quarter sized zine with 2 copies per sheet that will be cut and then folded
                    if(pageCount % 4 != 0) { // round up to nearest 2 sides
                        pageCount += 4-(pageCount % 4);
                    }
                    
                    pagesPerSheet = 4;
                    if(sheetsPerSig <= 0) {
                        sheetsPerSig = pageCount / pagesPerSheet;
                    }
                    pagesPerSig = sheetsPerSig * pagesPerSheet;
                    
                    if(zinePortrait) {
                        setPageOrientation(true);
                        if(spineSide) { // quarter (copy) duplex portrait side
                            for(let i = 0; i < pageCount / 4; i++) {
                                var sigCount = Math.floor(i / sheetsPerSig);
                                var s = 2 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                                var e = ((sigCount+1)*pagesPerSig) - (2*(i%sheetsPerSig)) - 1;
                            
                                sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page tl" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page tr" + foldLeft + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page bl" + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "b\"></canvas></section>";
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page br" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "b\"></canvas></section>";
                                sheetsHTML = sheetsHTML + "</section>";
                                            
                                sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2+1) + "\">";
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page tl" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page tr" + foldLeft + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page bl" + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "b\"></canvas></section>";
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page br" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "b\"></canvas></section>";
                                sheetsHTML = sheetsHTML + "</section>";
                            }
                        } else { // quarter (copy) duplex portrait top
                            for(let i = 0; i < pageCount / 4; i++) {
                                var sigCount = Math.floor(i / sheetsPerSig);
                                var s = 2 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                                var e = ((sigCount+1)*pagesPerSig) - (2*(i%sheetsPerSig)) - 1;
                            
                                sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                                if(!flipBackCover && e == pageCount-1) {
                                    sheetsHTML = sheetsHTML + "<section class=\"zine-page tl" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                                    sheetsHTML = sheetsHTML + "<section class=\"zine-page tr" + rt + cutRight + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "b\"></canvas></section>";
                                } else {
                                    sheetsHTML = sheetsHTML + "<section class=\"zine-page tl" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                                    sheetsHTML = sheetsHTML + "<section class=\"zine-page tr" + cutLeft + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "b\"></canvas></section>";
                                }
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page bl\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page br" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "b\"></canvas></section>";
                                sheetsHTML = sheetsHTML + "</section>";
                                            
                                sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2+1) + "\">";
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page tl" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page tr" + rt + cutRight + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "b\"></canvas></section>";
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page bl" + rt + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page br" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "b\"></canvas></section>";
                                sheetsHTML = sheetsHTML + "</section>";
                            }
                        }
                    } else {
                        setPageOrientation(false);
                        if(spineSide) { // quarter (copy) duplex landscape side
                            for(let i = 0; i < pageCount / 4; i++) {
                                var sigCount = Math.floor(i / sheetsPerSig);
                                var s = 2 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                                var e = ((sigCount+1)*pagesPerSig) - (2*(i%sheetsPerSig)) - 1;
                            
                                sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page tl" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page tr" + foldLeft + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page bl" + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "b\"></canvas></section>";
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page br" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "b\"></canvas></section>";
                                sheetsHTML = sheetsHTML + "</section>";
                                            
                                sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2+1) + "\">";
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page tl" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page tr" + foldLeft + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page bl" + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "b\"></canvas></section>";
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page br" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "b\"></canvas></section>";
                                sheetsHTML = sheetsHTML + "</section>";
                            }
                        } else { // quarter (copy) duplex landscape top
                            for(let i = 0; i < pageCount / 4; i++) {
                                var sigCount = Math.floor(i / sheetsPerSig);
                                var s = 2 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                                var e = ((sigCount+1)*pagesPerSig) - (2*(i%sheetsPerSig)) - 1;
                            
                                sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                                if(!flipBackCover && e == pageCount-1) {
                                    sheetsHTML = sheetsHTML + "<section class=\"zine-page tl" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                                    sheetsHTML = sheetsHTML + "<section class=\"zine-page tr" + rt + cutRight + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "b\"></canvas></section>";
                                } else {
                                    sheetsHTML = sheetsHTML + "<section class=\"zine-page tl" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                                    sheetsHTML = sheetsHTML + "<section class=\"zine-page tr" + cutLeft + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "b\"></canvas></section>";
                                }
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page bl" + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page br" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "b\"></canvas></section>";
                                sheetsHTML = sheetsHTML + "</section>";
                                            
                                sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2+1) + "\">";
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page tl" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page tr" + rt + cutRight + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "b\"></canvas></section>";
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page bl" + rt + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page br" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "b\"></canvas></section>";
                                sheetsHTML = sheetsHTML + "</section>";
                            }
                        }
                    }

                } else { // regular quarter-size style, where the bottom row will be nested into the top
                    // quarter size zines only need to have a multiple of 4 now, BUT
                    // right here we still want to add blank pages when it's not a multiple of 8
                    // these blank pages will be shifted around to the bottom half sheet during the selectFile() layout step
                    if(pageCount % 8 != 0) { // round up to nearest 2 sides
                        pageCount += 8-(pageCount % 8);
                    }
                    
                    pagesPerSheet = 8;
                    if(sheetsPerSig <= 0) {
                        sheetsPerSig = pageCount / pagesPerSheet;
                    }
                    pagesPerSig = sheetsPerSig * pagesPerSheet;
                    
                    if(zinePortrait) {
                        setPageOrientation(true);
                        if(spineSide) { // quarter duplex portrait side
                            for(let i = 0; i < pageCount / 8; i++) {
                                var sigCount = Math.floor(i / sheetsPerSig);
                                var s = 2 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                                var e = ((sigCount+1)*pagesPerSig) - (2*(i%sheetsPerSig)) - 1;
                                var m = s + (pagesPerSig / 4);
                                var n = e - (pagesPerSig / 4);
                            
                                sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page tl" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page tr" + foldLeft + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page bl" + "\"><canvas class=\"zine-canvas\" id=\"p" + (n) + "\"></canvas></section>";
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page br" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (m) + "\"></canvas></section>";
                                sheetsHTML = sheetsHTML + "</section>";
                                            
                                sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2+1) + "\">";
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page tl" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page tr" + foldLeft + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page bl" + "\"><canvas class=\"zine-canvas\" id=\"p" + (m+1) + "\"></canvas></section>";
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page br" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (n-1) + "\"></canvas></section>";
                                sheetsHTML = sheetsHTML + "</section>";
                            }
                        } else { // quarter duplex portrait top
                            for(let i = 0; i < pageCount / 8; i++) {
                                var sigCount = Math.floor(i / sheetsPerSig);
                                var s = 2 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                                var e = ((sigCount+1)*pagesPerSig) - (2*(i%sheetsPerSig)) - 1;
                                var m = s + (pagesPerSig / 4);
                                var n = e - (pagesPerSig / 4);
                            
                                sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page tl" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (n) + "\"></canvas></section>";
                                if(!flipBackCover && e == pageCount-1) {
                                    sheetsHTML = sheetsHTML + "<section class=\"zine-page tr" + rt + cutRight + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                                } else {
                                    sheetsHTML = sheetsHTML + "<section class=\"zine-page tr" + cutLeft + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                                }
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page bl" + "\"><canvas class=\"zine-canvas\" id=\"p" + (m) + "\"></canvas></section>";
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page br" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                                sheetsHTML = sheetsHTML + "</section>";
                                            
                                sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2+1) + "\">";
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page tl" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page tr" + rt + cutRight + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (n-1) + "\"></canvas></section>";
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page bl" + rt + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page br" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (m+1) + "\"></canvas></section>";
                                sheetsHTML = sheetsHTML + "</section>";
                            }
                        }
                    } else {
                        setPageOrientation(false);
                        if(spineSide) { // quarter duplex landscape side
                            for(let i = 0; i < pageCount / 8; i++) {
                                var sigCount = Math.floor(i / sheetsPerSig);
                                var s = 2 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                                var e = ((sigCount+1)*pagesPerSig) - (2*(i%sheetsPerSig)) - 1;
                                var m = s + (pagesPerSig / 4);
                                var n = e - (pagesPerSig / 4);
                            
                                sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page tl" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page tr" + foldLeft + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page bl" + "\"><canvas class=\"zine-canvas\" id=\"p" + (n) + "\"></canvas></section>";
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page br" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (m) + "\"></canvas></section>";
                                sheetsHTML = sheetsHTML + "</section>";
                                            
                                sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2+1) + "\">";
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page tl" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page tr" + foldLeft + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page bl" + "\"><canvas class=\"zine-canvas\" id=\"p" + (m+1) + "\"></canvas></section>";
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page br" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (n-1) + "\"></canvas></section>";
                                sheetsHTML = sheetsHTML + "</section>";
                            }
                        } else { // quarter duplex landscape top
                            for(let i = 0; i < pageCount / 8; i++) {
                                var sigCount = Math.floor(i / sheetsPerSig);
                                var s = 2 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                                var e = ((sigCount+1)*pagesPerSig) - (2*(i%sheetsPerSig)) - 1;
                                var m = s + (pagesPerSig / 4);
                                var n = e - (pagesPerSig / 4);
                            
                                sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page tl" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (n) + "\"></canvas></section>";
                                if(!flipBackCover && e == pageCount-1) {
                                    sheetsHTML = sheetsHTML + "<section class=\"zine-page tr" + rt + cutRight + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                                } else {
                                    sheetsHTML = sheetsHTML + "<section class=\"zine-page tr" + cutLeft + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                                }
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page bl" + "\"><canvas class=\"zine-canvas\" id=\"p" + (m) + "\"></canvas></section>";
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page br" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                                sheetsHTML = sheetsHTML + "</section>";
                                            
                                sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2+1) + "\">";
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page tl" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page tr" + rt + cutRight + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (n-1) + "\"></canvas></section>";
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page bl" + rt + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page br" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (m+1) + "\"></canvas></section>";
                                sheetsHTML = sheetsHTML + "</section>";
                            }
                        }
                    }
                }
            } else {    // QUARTER SINGLE
                if(pageCount % 4 != 0) { // round up to nearest 4 multiple
                    pageCount += 4-(pageCount % 4);
                }
                
                pagesPerSheet = 4;
                if(sheetsPerSig <= 0) {
                    sheetsPerSig = pageCount / pagesPerSheet;
                }
                pagesPerSig = sheetsPerSig * pagesPerSheet;
                
                if(zinePortrait) {
                    setPageOrientation(true);
                    if(spineSide) { // quarter single portrait side
                        for(let i = 0; i < pageCount / 4; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 2 * (i%sheetsPerSig) + (sigCount*pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (2*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " +  marginGuides + "\" id=\"s" + i + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page tl" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page tr" + rt + foldRight + foldTop +"\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page bl\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page br" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";    
                            sheetsHTML = sheetsHTML + "</section>";
                        }       
                    } else { // quarter single portrait top
                        for(let i = 0; i < pageCount / 4; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 2 * (i%sheetsPerSig) + (sigCount*pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (2*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " +  marginGuides + "\" id=\"s" + i + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page tl" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            if(!flipBackCover && e == pageCount-1) {
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page tr" + rt + foldRight + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            } else {
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page tr" + foldLeft + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            }
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page bl" + rt + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page br" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";    
                            sheetsHTML = sheetsHTML + "</section>";
                        }
                    }
                } else {
                    setPageOrientation(false);
                    if(spineSide) { // quarter single landscape side
                        for(let i = 0; i < pageCount / 4; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 2 * (i%sheetsPerSig) + (sigCount*pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (2*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " +  marginGuides + "\" id=\"s" + i + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page tl" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page tr" + rt + foldRight + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page bl" + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page br" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";    
                            sheetsHTML = sheetsHTML + "</section>";
                        }
                    } else { // quarter single landscape top
                        for(let i = 0; i < pageCount / 4; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 2 * (i%sheetsPerSig) + (sigCount*pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (2*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " +  marginGuides + "\" id=\"s" + i + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page tl" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            if(!flipBackCover && e == pageCount-1) {
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page tr" + rt + foldRight + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            } else {
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page tr" + foldLeft + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            }
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page bl" + rt + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page br" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";    
                            sheetsHTML = sheetsHTML + "</section>";
                        }
                    }
                }
            }
        } else if(size == SIZE_EIGHTH) {
            // orientation determines gridType, for both duplex & single (I think--not 100% on single)
            if(zinePortrait) {
                gridType = "eig-por";
            } else {
                gridType = "eig-lnd";
            }
            
            if(doubleSided) {  // EIGHTH DOUBLE
                if(pageCount % 16 != 0) { // round up to nearest 2 sides
                    pageCount += 16-(pageCount%16);
                }
                
                pagesPerSheet = 16;
                if(sheetsPerSig <= 0) {
                    sheetsPerSig = pageCount / pagesPerSheet;
                }
                pagesPerSig = sheetsPerSig * pagesPerSheet;
                
                if(zinePortrait) {
                    setPageOrientation(false);
                    
                    if(spineSide) {  // eight duplex portrait side
                        for(let i = 0; i < pageCount / 16; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 8 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (8*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page tl" + rt + cutTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page tml" + rt + foldRight + cutTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page tmr" + rt + cutRight + cutTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page tr" + rt + foldRight + cutTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page bl" + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page bml" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page bmr" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page br" + foldLeft+ "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2 + 1) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page tl" + rt + cutTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page tml" + rt + foldRight + cutTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page tmr" + rt + cutRight + cutTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page tr" + rt + foldRight + cutTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page bl" + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page bml" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page bmr" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page br" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                        }
                    } else {  // eight duplex portrait top
                        for(let i = 0; i < pageCount / 16; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 8 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (8*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page tl" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page tml" + cutLeft + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page tmr" + rt + cutRight + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-7) + "\"></canvas></section>";
                            if(!flipBackCover && e == pageCount-1) {
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page tr" + rt + cutRight + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            } else {
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page tr" + cutLeft + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            }
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page bl" + rt + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page bml" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page bmr" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page br" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2 + 1) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page tl" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page tml" + cutLeft + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page tmr" + rt + cutRight + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page tr" + cutLeft + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page bl" + rt + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page bml" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page bmr" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page br" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                        }
                    }
                } else {
                    setPageOrientation(true);
                    
                    if(spineSide) { // eight duplex landscape side
                        for(let i = 0; i < pageCount / 16; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 8 * (i%sheetsPerSig) + (sigCount  * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (8*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page tl" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page tml" + cutLeft + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page tmr" + rt + cutRight + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page tr" + cutLeft + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page bl" + rt + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page bml" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page bmr" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page br" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2 + 1) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page tl" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page tml" + cutLeft + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page tmr" + rt + cutRight + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page tr" + cutLeft + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page bl" + rt + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page bml" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page bmr" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page br" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                        }
                    } else {  // eight duplex landscape top
                        for(let i = 0; i < pageCount / 16; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 8 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = (sigCount+1)*pagesPerSig - (8*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page tl" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page tml" + foldLeft + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-7) + "\"></canvas></section>";
                            if(!flipBackCover && e == pageCount-1) {
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page tmr" + rt + cutRight + cutTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            } else {
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page tmr" + cutLeft + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            }
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page tr" + foldLeft + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page bl" + rt + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page bml" + rt + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page bmr" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page br" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2 + 1) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page tl" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page tml" + foldLeft + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page tmr" + cutLeft + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page tr" + foldLeft + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page bl" + rt + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page bml" + rt + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page bmr" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page br" + rt + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                        }
                    }
                }
            } else { // standard 8-page mini algo
                if(pageCount % 8 != 0) { // round up to nearest 2 sides
                    pageCount += 8-(pageCount%8);
                }
                
                pagesPerSheet = 8;
                if(sheetsPerSig <= 0) {
                    sheetsPerSig = pageCount / pagesPerSheet;
                }
                pagesPerSig = sheetsPerSig * pagesPerSheet;                
                
                if(zinePortrait) { // eight single portrait
                    setPageOrientation(false);
                    
                    if(spineSide) { // eight single portrait side
                        for(let i = 0; i < pageCount / 8; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 4 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (4*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page tl" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page tml" + rt + foldRight + cutTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page tmr" + rt + foldRight + cutTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page tr" + rt + foldRight + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page bl" + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page bml" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page bmr" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page br" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                        }
                    } else { // eight single portrait top
                        for(let i = 0; i < pageCount / 8; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 4 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (4*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i) + "\">";
                            if(!flipBackCover && e == pageCount-1) {
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page tl" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            } else {
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page tl" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            }
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page tml" + rt + cutRight + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page tmr" + foldLeft + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page tr" + rt + cutRight + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page bl" + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page bml" + rt + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page bmr" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page br" + rt + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                        }
                    }
                } else { // eight single landscape
                    setPageOrientation(true);
                    
                    if(spineSide) { // eight single landscape side
                        for(let i = 0; i < pageCount / 8; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 4 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (4*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page tl" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page tml" + foldLeft + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page tmr" + rt + foldRight + cutTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page tr" + foldLeft + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page bl" + rt + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page bml" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page bmr" + rt + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page br" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                        }
                    } else {
                        for(let i = 0; i < pageCount / 8; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 4 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (4*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page tl" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page tml" + rt + foldRight + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page tmr" + rt + cutRight + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page tr" + rt + foldRight + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page bl" + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page bml" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            if(!flipBackCover && e == pageCount-1) {
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page bmr" + rt + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            } else {
                                sheetsHTML = sheetsHTML + "<section class=\"zine-page bmr" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            }
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page br" + cutLeft +  "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                        }
                    }
                }    
            }      
        } else if (size == SIZE_12TH) { // 1/12th size
            // orientation determines gridType, for both duplex & single (I think--not 100% on single)
            if(zinePortrait) {
                gridType = "twlv-por";
            } else {
                gridType = "twlv-lnd";
            }
            
            if(doubleSided) { // 12th double sided
                if(pageCount % 24 != 0) { // round up to nearest 2 sides
                    pageCount += 24-(pageCount%24);
                }
                
                pagesPerSheet = 24;
                if(sheetsPerSig <= 0) {
                    sheetsPerSig = pageCount / pagesPerSheet;
                }
                pagesPerSig = sheetsPerSig * pagesPerSheet;  
                
                if(zinePortrait) { // 12th double portrait
                    setPageOrientation(false);
                    
                    if(spineSide) { // 12th double portrait side
                        for(let i = 0; i < pageCount / 24; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 12 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (12*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g04" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g05" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g14" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g15" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2+1) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g04" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g05" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g14" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g15" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                        }
                    } else { // 12th double portrait top
                        for(let i = 0; i < pageCount / 24; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 12 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (12*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + ((!flipBackCover && e == pageCount-1) ? rt + foldTop : foldBottom) + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g04" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g05" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g14" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g15" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2+1) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g04" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g05" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + rt + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g14" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g15" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                        }
                    }
                } else { // 12th double landscape
                    setPageOrientation(true);
                    
                    if(spineSide) { // 12th double landscape side
                        for(let i = 0; i < pageCount / 24; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 12 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (12*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g40" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g41" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g50" + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g51" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2+1) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g40" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g41" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g50" + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g51" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                        }
                    } else { // 12th double landscape top
                        for(let i = 0; i < pageCount / 24; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 12 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (12*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + ((!flipBackCover && e == pageCount-1) ? rt + foldTop : foldBottom) + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g40" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g41" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g50" + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g51" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2+1) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + rt + cutTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + rt + cutTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g40" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g41" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g50" + rt + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g51" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                        }
                    }
                }
            } else { // 12th single sided
                if(pageCount % 12 != 0) { // round up to nearest 2 sides
                    pageCount += 12-(pageCount%12);
                }
                
                pagesPerSheet = 12;
                if(sheetsPerSig <= 0) {
                    sheetsPerSig = pageCount / pagesPerSheet;
                }
                pagesPerSig = sheetsPerSig * pagesPerSheet;
            
                if(zinePortrait) { // 12th single portrait
                    setPageOrientation(false);
                    
                    if(spineSide) { // 12th single portrait side
                        for(let i = 0; i < pageCount / 12; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 6 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (6*(i%sheetsPerSig)) - 1;
                        
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g04" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g05" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g14" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g15" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                        }
                    } else { // 12th single portrait top
                        for(let i = 0; i < pageCount / 12; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 6 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (6*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + ((!flipBackCover && e == pageCount-1) ? rt + foldTop : foldBottom) + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + foldBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g04" + foldBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g05" + rt + cutRight + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + rt + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + rt + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g14" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g15" + rt + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                        }
                    }
                } else { // 12th single landscape
                    setPageOrientation(true);
                    
                    if(spineSide) { // 12th single landscape side
                        for(let i = 0; i < pageCount / 12; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 6 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (6*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + rt + cutTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + rt + cutTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g40" + rt + cutTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g41" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g50" + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g51" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                        }
                    } else { // 12th single landscape top
                        for(let i = 0; i < pageCount / 12; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 6 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (6*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + rt + foldRight + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + rt + cutRight + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + rt + cutRight + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + rt + cutRight + foldTop +"\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g40" + ((!flipBackCover && e == pageCount-1) ? rt + foldTop : foldBottom) + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g41" + rt + cutRight + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g50" + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g51" + rt + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                        }
                    }
                }
            }
        } else if (size == SIZE_16TH) { // 1/16th size
            // orientation determines gridType, for both duplex & single (I think--not 100% on single)
            if(zinePortrait) {
                gridType = "sxtn-por";
            } else {
                gridType = "sxtn-lnd";
            }
        
            if(doubleSided) { // 16th double sided
                if(pageCount % 32 != 0) { // round up to nearest 2 sides
                    pageCount += 32-(pageCount%32);
                }
                
                pagesPerSheet = 32;
                if(sheetsPerSig <= 0) {
                    sheetsPerSig = pageCount / pagesPerSheet;
                }
                pagesPerSig = sheetsPerSig * pagesPerSheet;
                
                if(zinePortrait) { // 16th double portrait
                    setPageOrientation(true);
                    
                    if(spineSide) { // 16th double portrait side
                        for(let i = 0; i < pageCount / 32; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 16 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (16*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-14) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+14) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2+1) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                        }
                    } else { // 16th double portrait top
                        for(let i = 0; i < pageCount / 32; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 16 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (16*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + ((!flipBackCover && e == pageCount-1) ? rt + foldTop : foldBottom) + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-14) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+14) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2+1) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + rt + cutTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + rt + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";                      
                        }
                    }
                } else { // 16th double landscape
                    setPageOrientation(false);
                    
                    if(spineSide) { // 16th double landscape side
                        for(let i = 0; i < pageCount / 32; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 16 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (16*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-14) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+14) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2+1) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                        }
                    } else { // 16th double landscape top
                        for(let i = 0; i < pageCount / 32; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 16 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (16*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + ((!flipBackCover && e == pageCount-1) ? rt + foldTop : foldBottom) + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-14) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+14) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2+1) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + rt + cutTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + rt + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";                   
                        }
                    }
                }
            } else { // 16th single sided
                if(pageCount % 16 != 0) { // round up to nearest 2 sides
                    pageCount += 16-(pageCount%16);
                }
                
                pagesPerSheet = 16;
                if(sheetsPerSig <= 0) {
                    sheetsPerSig = pageCount / pagesPerSheet;
                }
                pagesPerSig = sheetsPerSig * pagesPerSheet;
                
                if(zinePortrait) { // 16th single portrait
                    setPageOrientation(true);
                    
                    if(spineSide) { // 16th single portrait side
                        for(let i = 0; i < pageCount / 16; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 8 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (8*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + rt + foldRight + cutTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + rt + foldRight + cutTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + rt + foldRight + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + foldLeft + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + cutLeft + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + foldLeft + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + rt + foldRight + cutTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + rt + cutRight + cutTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + rt + foldRight + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                        }
                    } else { // 16th single portrait top
                        for(let i = 0; i < pageCount / 16; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 8 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (8*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + foldLeft + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + rt + cutRight + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + foldLeft + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + rt + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + cutLeft + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + rt + foldRight + cutTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + cutLeft + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + cutLeft + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + rt + foldRight + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + ((!flipBackCover && e == pageCount-1) ? rt + cutRight + foldTop : cutLeft + foldBottom) + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + rt + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                        }
                    }
                } else { // 16th single landscape
                    setPageOrientation(false);
                    
                    if(spineSide) { // 16th single landscape side
                        for(let i = 0; i < pageCount / 16; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 8 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (8*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + foldLeft + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + foldLeft + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + foldLeft + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + rt + cutTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + rt + foldRight + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + rt + cutRight + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + rt + foldRight + cutTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + foldLeft + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + cutLeft + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + foldLeft + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + rt + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + rt + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + rt + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + rt + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";                       
                        }
                    } else { // 16th single landscape top
                        for(let i = 0; i < pageCount / 16; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 8 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (8*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + rt + foldRight + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + cutLeft + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + rt + foldRight + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + rt + cutRight + cutTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + foldLeft + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + rt + cutRight + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + ((!flipBackCover && e == pageCount-1) ? rt + foldTop : foldBottom) + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + rt + cutRight + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + foldLeft + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + rt + cutRight + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + rt + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + rt + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";                        
                        }
                    }
                }
            }
        } else if (size == SIZE_24TH) { // 1/24th size
            // orientation determines gridType, for both duplex & single (I think--not 100% on single)
            if(zinePortrait) {
                gridType = "twfr-por";
            } else {
                gridType = "twfr-lnd";
            }
            
            if(doubleSided) { // 24th double sided
                if(pageCount % 48 != 0) { // round up to nearest 2 sides
                    pageCount += 48-(pageCount%48);
                }
                
                pagesPerSheet = 48;
                if(sheetsPerSig <= 0) {
                    sheetsPerSig = pageCount / pagesPerSheet;
                }
                pagesPerSig = sheetsPerSig * pagesPerSheet;
                
                if(zinePortrait) { // 24th double portrait
                    setPageOrientation(false);
                    
                    if(spineSide) { // 24th double portrait side
                        for(let i = 0; i < pageCount / 48; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 24 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (24*(i%sheetsPerSig)) - 1;
                                                     
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g04" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g05" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+4) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-6) + "\"></canvas></section>";                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + cutBottom + foldLeft +"\"><canvas class=\"zine-canvas\" id=\"p" + (s+8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g14" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g15" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+10) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-12) + "\"></canvas></section>";                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-14) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+14) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g24" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-16) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g25" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+16) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-18) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+18) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-20) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+20) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g34" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-22) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g35" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+22) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2+1) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g04" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g05" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g14" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g15" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-7) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+17) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-17) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g24" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g25" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-13) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+23) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-23) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+21) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-21) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g34" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+19) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g35" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-19) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                        }
                    } else { // 24th double portrait top
                        for(let i = 0; i < pageCount / 48; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 24 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (24*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + ((!flipBackCover && e == pageCount-1) ? rt + foldTop : foldBottom) + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g04" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g05" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-10) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g14" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g15" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+10) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-14) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-16) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-18) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g24" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-20) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g25" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-22) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+14) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+16) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+18) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g34" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+20) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g35" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+22) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2+1) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g04" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g05" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + rt + cutTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g14" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g15" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-23) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-21) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-19) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-17) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g24" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g25" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-13) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + rt + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+23) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+21) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+19) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+17) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g34" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g35" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";                   
                        }
                    }
                } else { // 24th double landscape
                    setPageOrientation(true);
                    
                    if(spineSide) { // 24th double landscape side
                        for(let i = 0; i < pageCount / 48; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 24 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (24*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+6) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+10) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-14) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+14) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g40" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-16) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g41" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+16) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g42" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-18) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g43" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+18) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g50" + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-20) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g51" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+20) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g52" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-22) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g53" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+22) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2+1) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-5) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-9) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-13) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g40" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+19) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g41" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-19) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g42" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+17) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g43" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-17) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g50" + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+23) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g51" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-23) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g52" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+21) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g53" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-21) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                        
                        }
                    } else { // 24th double landscape top
                        for(let i = 0; i < pageCount / 48; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 24 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (24*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + ((!flipBackCover && e == pageCount-1) ? rt + foldTop : foldBottom) + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-6) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+6) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-14) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+14) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g40" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-16) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g41" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-18) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g42" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-20) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g43" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-22) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g50" + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+16) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g51" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+18) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g52" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+20) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g53" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+22) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2+1) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + rt + cutTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-9) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + rt + cutTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+9) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g40" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-23) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g41" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-21) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g42" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-19) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g43" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-17) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g50" + rt + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+23) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g51" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+21) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g52" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+19) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g53" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+17) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";                        
                        }
                    }
                }
            } else { // 24th single sided
                if(pageCount % 24 != 0) { // round up to nearest 2 sides
                    pageCount += 24-(pageCount%24)
                }
                
                pagesPerSheet = 24;
                if(sheetsPerSig <= 0) {
                    sheetsPerSig = pageCount / pagesPerSheet;
                }
                pagesPerSig = sheetsPerSig * pagesPerSheet;
                
                if(zinePortrait) { // 24th single portrait
                    setPageOrientation(false);
                    
                    if(spineSide) { // 24th single portrait side
                        for(let i = 0; i < pageCount / 24; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 12 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (12*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g04" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g05" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+9) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + foldBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g14" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g15" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+8) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g24" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g25" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g34" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g35" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";                        
                        }
                    } else { // 24th single portrait top
                        for(let i = 0; i < pageCount / 24; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 12 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (12*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + foldBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + foldBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g04" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g05" + foldBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g14" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g15" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g24" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g25" + ((!flipBackCover && e == pageCount-1) ? rt + cutRight + foldTop : foldBottom + cutLeft) + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + rt + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g34" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g35" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";                        
                        }
                    }
                } else { // 24th single landscape
                    setPageOrientation(true);
                    
                    if(spineSide) { // 24th single landscape side
                        for(let i = 0; i < pageCount / 24; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 12 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (12*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + foldBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + rt + cutTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + foldBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+4) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + rt + cutTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+5) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g40" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g41" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g42" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g43" + foldBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+8) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g50" + rt + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g51" + rt + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g52" + rt + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g53" + rt + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";                                                  
                        }
                    } else { // 24th single landscape top
                        for(let i = 0; i < pageCount / 24; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 12 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (12*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-9) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-10) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + foldBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-11) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+11) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g40" + ((!flipBackCover && e == pageCount-1) ? rt + foldTop : foldBottom) + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g41" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g42" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g43" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+10) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g50" + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g51" + rt + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g52" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g53" + rt + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";                          
                        }
                    }
                }
            }
        } else if (size == SIZE_32ND) { // 1/32nd size
            // orientation determines gridType, for both duplex & single (I think--not 100% on single)
            if(zinePortrait) {
                gridType = "thtw-por";
            } else {
                gridType = "thtw-lnd";
            }
            
            if(doubleSided) { // 32nd double sided
                if(pageCount % 64 != 0) { // round up to nearest 2 sides
                    pageCount += 64-(pageCount%64)
                }
                
                pagesPerSheet = 64;
                if(sheetsPerSig <= 0) {
                    sheetsPerSig = pageCount / pagesPerSheet;
                }
                pagesPerSig = sheetsPerSig * pagesPerSheet;
                
                if(zinePortrait) { // 32nd double portrait
                    setPageOrientation(false);
                    
                    if(spineSide) { // 32nd double portrait side
                        for(let i = 0; i < pageCount / 64; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 32 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (32*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g04" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g05" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g06" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g07" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+6) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g14" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g15" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g16" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-14) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g17" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+14) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-16) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+16) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-18) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+18) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g24" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-20) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g25" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+20) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g26" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-22) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g27" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+22) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-24) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+24) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-26) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+26) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g34" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-28) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g35" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+28) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g36" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-30) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g37" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+30) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                            
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2+1) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g04" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g05" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g06" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g07" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g14" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g15" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g16" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g17" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-9) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+23) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-23) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+21) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-21) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g24" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+19) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g25" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-19) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g26" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+17) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g27" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-17) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+31) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-31) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+29) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-29) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g34" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+27) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g35" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-27) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g36" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+25) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g37" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-25) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                        }
                    } else { // 32nd double portrait top
                        for(let i = 0; i < pageCount / 64; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 32 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (32*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + ((!flipBackCover && e == pageCount-1) ? rt + foldTop : foldBottom) + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g04" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g05" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g06" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g07" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-14) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g14" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g15" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g16" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g17" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+14) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-16) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-18) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-20) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-22) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g24" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-24) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g25" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-26) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g26" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-28) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g27" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-30) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+16) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+18) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+20) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+22) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g34" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+24) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g35" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+26) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g36" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+28) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g37" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+30) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                            
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2+1) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g04" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g05" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g06" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g07" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + rt + cutTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g14" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g15" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g16" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g17" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-31) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-29) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-27) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-25) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g24" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-23) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g25" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-21) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g26" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-19) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g27" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-17) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + rt + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+31) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+29) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+27) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+25) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g34" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+23) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g35" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+21) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g36" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+19) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g37" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+17) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";                          
                        }
                    }
                } else { // 32nd double landscape
                    setPageOrientation(true);
                    
                    if(spineSide) { // 32nd double landscape side
                        for(let i = 0; i < pageCount / 64; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 32 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (32*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+6) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+10) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-14) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+14) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g40" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-16) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g41" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+16) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g42" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-18) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g43" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+18) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g50" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-20) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g51" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+20) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g52" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-22) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g53" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+22) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g60" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-24) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g61" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+24) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g62" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-26) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g63" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+26) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g70" + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-28) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g71" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+28) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g72" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-30) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g73" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+30) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                            
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2+1) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-5) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-9) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-13) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g40" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+19) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g41" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-19) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g42" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+17) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g43" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-17) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g50" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+23) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g51" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-23) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g52" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+21) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g53" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-21) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g60" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+27) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g61" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-27) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g62" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+25) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g63" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-25) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g70" + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+31) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g71" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-31) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g72" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+29) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g73" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-29) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                        }
                    } else { // 32nd double landscape top
                        for(let i = 0; i < pageCount / 64; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 32 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (32*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + ((!flipBackCover && e == pageCount-1) ? rt + foldTop : foldBottom) + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-6) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+6) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-14) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+14) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g40" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-16) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g41" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-18) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g42" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-20) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g43" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-22) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g50" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+16) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g51" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+18) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g52" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+20) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g53" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+22) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g60" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-24) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g61" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-26) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g62" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-28) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g63" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-30) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g70" + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+24) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g71" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+26) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g72" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+28) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g73" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+30) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                            
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2+1) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + rt + cutTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-9) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + rt + cutTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+9) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g40" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-23) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g41" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-21) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g42" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-19) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g43" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-17) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g50" + rt + cutTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+23) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g51" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+21) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g52" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+19) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g53" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+17) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g60" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-31) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g61" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-29) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g62" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-27) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g63" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-25) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g70" + rt + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+31) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g71" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+29) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g72" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+27) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g73" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+25) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";                     
                        }
                    }
                }
            } else { // 32nd single sided
                if(pageCount % 32 != 0) { // round up to nearest 2 sides
                    pageCount += 32-(pageCount%32)
                }
                
                pagesPerSheet = 32;
                if(sheetsPerSig <= 0) {
                    sheetsPerSig = pageCount / pagesPerSheet;
                }
                pagesPerSig = sheetsPerSig * pagesPerSheet;
                
                if(zinePortrait) { // 32nd single portrait
                    setPageOrientation(false);
                    
                    if(spineSide) { // 32nd single portrait side
                        for(let i = 0; i < pageCount / 32; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 16 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (16*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+14) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g04" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g05" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g06" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g07" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+9) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-14) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + foldBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g14" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g15" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g16" + cutBottom +  foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g17" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+8) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g24" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g25" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g26" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g27" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g34" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g35" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g36" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g37" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                        }
                    } else { // 32nd single portrait top
                        for(let i = 0; i < pageCount / 32; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 16 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (16*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + foldBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-14) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + foldBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g04" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g05" + foldBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g06" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g07" + foldBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g14" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g15" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g16" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g17" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+14) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g24" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g25" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g26" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g27" + ((!flipBackCover && e == pageCount-1) ? rt + foldTop + cutRight : foldBottom + cutLeft) + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + rt + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g34" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g35" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g36" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g37" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";                        
                        }
                    }
                } else { // 32nd single landscape
                    setPageOrientation(true);
                    
                    if(spineSide) { // 32nd single landscape side
                        for(let i = 0; i < pageCount / 32; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 16 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (16*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + foldBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + rt + cutTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + foldBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+4) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + rt + cutTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + rt + foldTop + cutRight +"\"><canvas class=\"zine-canvas\" id=\"p" + (s+6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+5) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g40" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g41" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g42" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g43" + foldBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+8) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g50" + rt + cutTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g51" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g52" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g53" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+9) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g60" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-14) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g61" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g62" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g63" + foldBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+12) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g70" + rt + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g71" + rt + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g72" + rt + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+14) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g73" + rt + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";                        
                        }
                    } else { // 32nd single landscape top
                        for(let i = 0; i < pageCount / 32; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 16 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (16*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-14) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-15) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+15) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+14) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+13) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g40" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g41" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g42" + foldBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g43" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+12) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g50" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g51" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g52" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g53" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+11) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g60" + ((!flipBackCover && e == pageCount-1) ? rt + foldTop : foldBottom) + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g61" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g62" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g63" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+10) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g70" + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g71" + rt + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g72" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g73" + rt + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                        }
                    }
                }
            }
        } else if (size == SIZE_36TH) { // 1/36th size
            // orientation determines gridType, for both duplex & single (I think--not 100% on single)
            if(zinePortrait) {
                gridType = "thsx-por";
            } else {
                gridType = "thsx-lnd";
            }
            
            if(doubleSided) { // 36th double sided
                if(pageCount % 72 != 0) { // round up to nearest 2 sides
                    pageCount += 72-(pageCount%72);
                }
                
                pagesPerSheet = 72;
                if(sheetsPerSig <= 0) {
                    sheetsPerSig = pageCount / pagesPerSheet;
                }
                pagesPerSig = sheetsPerSig * pagesPerSheet;
                
                if(zinePortrait) { // 36th double portrait
                    setPageOrientation(true);
                    
                    if(spineSide) { // 36th double portrait side
                        for(let i = 0; i < pageCount / 72; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 36 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (36*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g04" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g05" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+4) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g14" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g15" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+10) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-14) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+14) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g24" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-16) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g25" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+16) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-18) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+18) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-20) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+20) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g34" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-22) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g35" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+22) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g40" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-24) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g41" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+24) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g42" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-26) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g43" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+26) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g44" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-28) + "\"></canvas></section>";                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g45" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+28) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g50" + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-30) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g51" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+30) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g52" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-32) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g53" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+32) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g54" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-34) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g55" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+34) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2+1) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g04" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g05" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g14" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g15" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-7) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+17) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-17) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g24" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g25" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-13) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+23) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-23) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+21) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-21) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g34" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+19) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g35" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-19) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g40" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+29) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g41" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-29) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g42" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+27) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g43" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-27) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g44" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+25) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g45" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-25) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g50" + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+35) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g51" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-35) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g52" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+33) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g53" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-33) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g54" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+31) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g55" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-31) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                        }
                    } else { // 36th double portrait top
                        for(let i = 0; i < pageCount / 72; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 36 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (36*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + ((!flipBackCover && e == pageCount-1) ? rt + foldTop : foldBottom) + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g04" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g05" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-10) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g14" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g15" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+10) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-14) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-16) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-18) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g24" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-20) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g25" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-22) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+14) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+16) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+18) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g34" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+20) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g35" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+22) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g40" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-24) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g41" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-26) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g42" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-28) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g43" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-30) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g44" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-32) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g45" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-34) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g50" + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+24) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g51" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+26) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g52" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+28) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g53" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+30) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g54" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+32) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g55" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+34) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2+1) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g04" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g05" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + rt + cutTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g14" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g15" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-23) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-21) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-19) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-17) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g24" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g25" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-13) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + rt + cutTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+23) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+21) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+19) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+17) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g34" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g35" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+13) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g40" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-35) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g41" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-33) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g42" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-31) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g43" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-29) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g44" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-27) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g45" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-25) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g50" + rt + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+35) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g51" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+33) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g52" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+31) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g53" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+29) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g54" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+27) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g55" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+25) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";                        
                        }
                    }
                } else { // 36th double landscape
                    setPageOrientation(false);
                    
                    if(spineSide) { // 36th double landscape side
                        for(let i = 0; i < pageCount / 72; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 36 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (36*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g04" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g05" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+4) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g14" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g15" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+10) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-14) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+14) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g24" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-16) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g25" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+16) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-18) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+18) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-20) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+20) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g34" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-22) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g35" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+22) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g40" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-24) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g41" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+24) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g42" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-26) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g43" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+26) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g44" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-28) + "\"></canvas></section>";                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g45" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+28) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g50" + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-30) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g51" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+30) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g52" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-32) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g53" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+32) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g54" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-34) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g55" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+34) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2+1) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g04" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g05" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g14" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g15" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-7) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+17) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-17) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g24" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g25" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-13) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+23) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-23) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+21) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-21) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g34" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+19) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g35" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-19) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g40" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+29) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g41" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-29) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g42" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+27) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g43" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-27) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g44" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+25) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g45" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-25) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g50" + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+35) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g51" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-35) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g52" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+33) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g53" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-33) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g54" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+31) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g55" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-31) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";                        
                        }
                    } else { // 36th double landscape top
                        for(let i = 0; i < pageCount / 72; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 36 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (36*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + ((!flipBackCover && e == pageCount-1) ? rt + foldTop : foldBottom) + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g04" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g05" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-10) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g14" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g15" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+10) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-14) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-16) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-18) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g24" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-20) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g25" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-22) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+14) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+16) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+18) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g34" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+20) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g35" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+22) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g40" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-24) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g41" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-26) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g42" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-28) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g43" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-30) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g44" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-32) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g45" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-34) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g50" + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+24) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g51" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+26) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g52" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+28) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g53" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+30) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g54" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+32) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g55" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+34) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2+1) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g04" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g05" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + rt + cutTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g14" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g15" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-23) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-21) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-19) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-17) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g24" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g25" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-13) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + rt + cutTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+23) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+21) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+19) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+17) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g34" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g35" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+13) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g40" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-35) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g41" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-33) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g42" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-31) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g43" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-29) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g44" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-27) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g45" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-25) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g50" + rt + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+35) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g51" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+33) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g52" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+31) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g53" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+29) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g54" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+27) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g55" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+25) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";                     
                        }
                    }
                }
            } else { // 36th single sided
                if(pageCount % 36 != 0) { // round up to nearest 2 sides
                    pageCount += 36-(pageCount%36);
                }
                
                pagesPerSheet = 36;
                if(sheetsPerSig <= 0) {
                    sheetsPerSig = pageCount / pagesPerSheet;
                }
                pagesPerSig = sheetsPerSig * pagesPerSheet;
                
                if(zinePortrait) { // 36th single portrait
                    setPageOrientation(true);
                    
                    if(spineSide) { // 36th single portrait side
                        for(let i = 0; i < pageCount / 36; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 18 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (18*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-14) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-16) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g04" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-17) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g05" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+17) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + foldBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+14) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g14" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g15" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+16) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g24" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g25" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+9) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + foldBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g34" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g35" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+8) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g40" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g41" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g42" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g43" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g44" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g45" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g50" + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g51" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g52" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g53" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g54" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g55" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";                        
                        }
                    } else { // 36th single portrait top
                        for(let i = 0; i < pageCount / 36; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 18 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (18*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g04" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g05" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-13) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g14" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g15" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-14) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + foldBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g24" + foldBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g25" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-15) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g34" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+14) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g35" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-16) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g40" + ((!flipBackCover && e == pageCount-1) ? rt + foldTop : foldBottom) + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g41" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g42" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g43" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g44" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g45" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-17) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g50" + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g51" + rt + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g52" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g53" + rt + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g54" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+16) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g55" + rt + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+17) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";                        
                        }
                    }
                } else { // 36th single landscape
                    setPageOrientation(false);
                    
                    if(spineSide) { // 36th single landscape side
                        for(let i = 0; i < pageCount / 36; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 18 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (18*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-14) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-16) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g04" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-17) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g05" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+17) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + foldBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+14) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g14" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g15" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+16) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g24" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g25" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+9) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + foldBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g34" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g35" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+8) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g40" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g41" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g42" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g43" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g44" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g45" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g50" + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g51" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g52" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g53" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g54" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g55" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";                      
                        }
                    } else { // 36th single landscape top
                        for(let i = 0; i < pageCount / 36; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 18 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (18*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g04" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g05" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-13) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g14" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g15" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-14) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + foldBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g24" + foldBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g25" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-15) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g34" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+14) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g35" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-16) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g40" + ((!flipBackCover && e == pageCount-1) ? rt + foldTop : foldBottom) + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g41" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g42" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g43" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g44" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g45" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-17) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g50" + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g51" + rt + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g52" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g53" + rt + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g54" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+16) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g55" + rt + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+17) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";                    
                        }
                    }
                }
            }
        } else if (size == SIZE_48TH) { // 1/48th size
            // orientation determines gridType, for both duplex & single (I think--not 100% on single)
            if(zinePortrait) {
                gridType = "frei-por";
            } else {
                gridType = "frei-lnd";
            }
            
            if(doubleSided) { // 48th double sided
                if(pageCount % 96 != 0) { // round up to nearest 2 sides
                    pageCount += 96-(pageCount%96);
                }
                
                pagesPerSheet = 96;
                if(sheetsPerSig <= 0) {
                    sheetsPerSig = pageCount / pagesPerSheet;
                }
                pagesPerSig = sheetsPerSig * pagesPerSheet;
                
                if(zinePortrait) { // 48th double portrait
                    setPageOrientation(false);
                    
                    if(spineSide) { // 48th double portrait side
                        for(let i = 0; i < pageCount / 96; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 48 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (48*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g04" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g05" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g06" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g07" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+6) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g14" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g15" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g16" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-14) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g17" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+14) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-16) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+16) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-18) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+18) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g24" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-20) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g25" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+20) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g26" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-22) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g27" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+22) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-24) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+24) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-26) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+26) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g34" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-28) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g35" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+28) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g36" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-30) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g37" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+30) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g40" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-32) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g41" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+32) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g42" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-34) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g43" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+34) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g44" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-36) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g45" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+36) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g46" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-38) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g47" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+38) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g50" + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-40) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g51" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+40) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g52" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-42) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g53" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+42) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g54" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-44) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g55" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+44) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g56" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-46) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g57" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+46) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2+1) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g04" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g05" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g06" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g07" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g14" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g15" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g16" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g17" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-9) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+23) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-23) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+21) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-21) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g24" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+19) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g25" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-19) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g26" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+17) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g27" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-17) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+31) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-31) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+29) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-29) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g34" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+27) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g35" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-27) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g36" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+25) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g37" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-25) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g40" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+39) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g41" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-39) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g42" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+37) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g43" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-37) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g44" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+35) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g45" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-35) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g46" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+33) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g47" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-33) + "\"></canvas></section>";

                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g50" + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+47) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g51" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-47) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g52" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+45) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g53" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-45) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g54" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+43) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g55" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-43) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g56" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+41) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g57" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-41) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";  
                        }
                    } else { // 48th double portrait top
                        for(let i = 0; i < pageCount / 96; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 48 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (48*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + ((!flipBackCover && e == pageCount-1) ? rt + foldTop : foldBottom) + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + foldBottom + cutLeft +  "\"><canvas class=\"zine-canvas\" id=\"p" + (e-4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + foldBottom + cutLeft +  "\"><canvas class=\"zine-canvas\" id=\"p" + (e-6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g04" + foldBottom + cutLeft +  "\"><canvas class=\"zine-canvas\" id=\"p" + (e-8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g05" + foldBottom + cutLeft +  "\"><canvas class=\"zine-canvas\" id=\"p" + (e-10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g06" + foldBottom + cutLeft +  "\"><canvas class=\"zine-canvas\" id=\"p" + (e-12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g07" + foldBottom + cutLeft +  "\"><canvas class=\"zine-canvas\" id=\"p" + (e-14) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g14" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g15" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g16" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g17" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+14) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-16) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-18) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-20) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-22) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g24" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-24) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g25" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-26) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g26" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-28) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g27" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-30) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+16) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+18) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+20) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+22) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g34" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+24) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g35" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+26) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g36" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+28) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g37" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+30) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g40" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-32) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g41" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-34) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g42" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-36) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g43" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-38) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g44" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-40) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g45" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-42) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g46" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-44) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g47" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-46) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g50" + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+32) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g51" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+34) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g52" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+36) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g53" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+38) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g54" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+40) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g55" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+42) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g56" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+44) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g57" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+46) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2+1) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g04" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g05" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g06" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g07" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + rt + cutTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g14" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g15" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g16" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g17" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-31) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-29) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-27) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-25) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g24" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-23) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g25" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-21) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g26" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-19) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g27" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-17) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + rt + cutTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+31) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+29) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+27) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+25) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g34" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+23) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g35" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+21) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g36" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+19) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g37" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+17) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g40" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-47) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g41" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-45) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g42" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-43) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g43" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-41) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g44" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-39) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g45" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-37) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g46" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-35) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g47" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-33) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g50" + rt + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+47) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g51" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+45) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g52" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+43) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g53" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+41) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g54" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+39) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g55" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+37) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g56" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+35) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g57" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+33) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>"; 
                        }
                    }
                } else { // 48th double landscape
                    setPageOrientation(true);
                    
                    if(spineSide) { // 48th double landscape side
                        for(let i = 0; i < pageCount / 96; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 48 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (48*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g04" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g05" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+4) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g14" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g15" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+10) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-14) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+14) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g24" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-16) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g25" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+16) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-18) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+18) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-20) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+20) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g34" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-22) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g35" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+22) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g40" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-24) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g41" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+24) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g42" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-26) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g43" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+26) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g44" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-28) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g45" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+28) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g50" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-30) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g51" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+30) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g52" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-32) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g53" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+32) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g54" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-34) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g55" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+34) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g60" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-36) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g61" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+36) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g62" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-38) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g63" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+38) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g64" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-40) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g65" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+40) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g70" + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-42) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g71" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+42) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g72" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-44) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g73" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+44) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g74" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-46) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g75" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+46) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2+1) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g04" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g05" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g14" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g15" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-7) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+17) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-17) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g24" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g25" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-13) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+23) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-23) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+21) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-21) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g34" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+19) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g35" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-19) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g40" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+29) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g41" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-29) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g42" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+27) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g43" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-27) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g44" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+25) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g45" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-25) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g50" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+35) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g51" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-35) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g52" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+33) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g53" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-33) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g54" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+31) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g55" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-31) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g60" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+41) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g61" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-41) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g62" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+39) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g63" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-39) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g64" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+37) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g65" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-37) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g70" + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+47) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g71" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-47) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g72" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+45) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g73" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-45) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g74" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+43) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g75" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-43) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>"; 
                        }
                    } else { // 48th double landscape top
                        for(let i = 0; i < pageCount / 96; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 48 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (48*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + ((!flipBackCover && e == pageCount-1) ? rt + foldTop : foldBottom) + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g04" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g05" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-10) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g14" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g15" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+10) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-14) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-16) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-18) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g24" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-20) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g25" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-22) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+14) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+16) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+18) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g34" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+20) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g35" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+22) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g40" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-24) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g41" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-26) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g42" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-28) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g43" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-30) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g44" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-32) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g45" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-34) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g50" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+24) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g51" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+26) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g52" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+28) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g53" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+30) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g54" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+32) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g55" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+34) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g60" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-36) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g61" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-38) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g62" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-40) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g63" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-42) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g64" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-44) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g65" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-46) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g70" + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+36) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g71" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+38) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g72" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+40) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g73" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+42) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g74" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+44) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g75" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+46) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2+1) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g04" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g05" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + rt + cutTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g14" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g15" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-23) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-21) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-19) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-17) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g24" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g25" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-13) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + rt + cutTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+23) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+21) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+19) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+17) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g34" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g35" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+13) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g40" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-35) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g41" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-33) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g42" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-31) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g43" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-29) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g44" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-27) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g45" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-25) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g50" + rt + cutTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+35) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g51" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+33) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g52" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+31) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g53" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+29) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g54" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+27) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g55" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+25) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g60" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-47) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g61" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-45) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g62" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-43) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g63" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-41) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g64" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-39) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g65" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-37) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g70" + rt + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+47) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g71" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+45) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g72" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+43) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g73" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+41) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g74" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+39) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g75" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+37) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>"; 
                        }
                    }
                }
            } else { // 48th single sided
                if(pageCount % 48 != 0) { // round up to nearest 2 sides
                    pageCount += 48-(pageCount%48);
                }
                
                pagesPerSheet = 48;
                if(sheetsPerSig <= 0) {
                    sheetsPerSig = pageCount / pagesPerSheet;
                }
                pagesPerSig = sheetsPerSig * pagesPerSheet;
                
                if(zinePortrait) { // 48th single portrait
                    setPageOrientation(false);
                    
                    if(spineSide) { // 48th single portrait side
                        for(let i = 0; i < pageCount / 48; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 24 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (24*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-23) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+23) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+22) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+21) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g04" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+20) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g05" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+19) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g06" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+18) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g07" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+17) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-22) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-21) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-20) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + foldBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-19) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g14" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g15" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+14) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g16" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g17" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+16) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-16) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-17) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-18) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g24" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g25" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g26" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g27" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+9) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-14) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + foldBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g34" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g35" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g36" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g37" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+8) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g40" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g41" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g42" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g43" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g44" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g45" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g46" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g47" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g50" + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g51" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g52" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g53" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g54" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g55" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g56" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g57" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                        }
                    } else { // 48th single portrait top
                        for(let i = 0; i < pageCount / 48; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 24 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (24*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g04" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g05" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g06" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-16) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g07" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-17) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g14" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g15" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-14) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g16" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g17" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-18) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + foldBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g24" + foldBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g25" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+20) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g26" + foldBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+21) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g27" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-19) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g34" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+14) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g35" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+19) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g36" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+22) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g37" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-20) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g40" + ((!flipBackCover && e == pageCount-1) ? rt + foldTop : foldBottom) + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g41" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g42" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g43" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g44" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g45" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+18) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g46" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+23) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g47" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-21) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g50" + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g51" + rt + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g52" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g53" + rt + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g54" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+16) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g55" + rt + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+17) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g56" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-23) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g57" + rt + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-22) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";                        
                        }
                    }
                } else { // 48th single landscape
                    setPageOrientation(true);
                    
                    if(spineSide) { // 48th single landscape side
                        for(let i = 0; i < pageCount / 48; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 24 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (24*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-17) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-18) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-19) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-20) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g04" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-21) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g05" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-22) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-16) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + foldBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+21) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+22) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g14" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+23) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g15" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-23) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-14) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+20) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+19) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g24" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+18) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g25" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+17) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + foldBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+14) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g34" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g35" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+16) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g40" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g41" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g42" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g43" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g44" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g45" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+9) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g50" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g51" + foldBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g52" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g53" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g54" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g55" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+8) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g60" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g61" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g62" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g63" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g64" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g65" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g70" + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g71" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g72" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g73" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g74" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g75" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                        }
                    } else { // 48th single landscape top
                        for(let i = 0; i < pageCount / 48; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 24 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (24*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-14) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g04" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-22) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g05" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-23) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-16) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g14" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-21) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g15" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+23) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-17) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g24" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-20) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g25" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+22) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-18) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g34" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-19) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g35" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+21) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g40" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g41" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g42" + foldBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g43" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g44" + foldBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g45" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+20) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g50" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g51" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g52" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g53" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g54" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+14) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g55" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+19) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g60" + ((!flipBackCover && e == pageCount-1) ? rt + foldTop : foldBottom) + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g61" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g62" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g63" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g64" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g65" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+18) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g70" + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g71" + rt + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g72" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g73" + rt + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g74" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+16) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g75" + rt + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+17) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                        }
                    }
                }
            }
        } else if (size == SIZE_64TH) { // 1/64th size
            // orientation determines gridType, for both duplex & single (I think--not 100% on single)
            if(zinePortrait) {
                gridType = "sxfr-por";
            } else {
                gridType = "sxfr-lnd";
            }
            
            if(doubleSided) { // 64th double sided
                if(pageCount % 128 != 0) { // round up to nearest 2 sides
                    pageCount += 128-(pageCount%128);
                }
                
                pagesPerSheet = 128;
                if(sheetsPerSig <= 0) {
                    sheetsPerSig = pageCount / pagesPerSheet;
                }
                pagesPerSig = sheetsPerSig * pagesPerSheet;
                
                if(zinePortrait) { // 64th double portrait
                    setPageOrientation(true);
                    
                    if(spineSide) { // 64th double portrait side
                        for(let i = 0; i < pageCount / 128; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 64 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (64*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g04" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g05" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g06" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g07" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+6) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g14" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g15" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g16" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-14) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g17" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+14) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-16) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+16) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-18) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+18) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g24" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-20) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g25" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+20) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g26" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-22) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g27" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+22) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-24) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+24) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-26) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+26) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g34" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-28) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g35" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+28) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g36" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-30) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g37" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+30) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g40" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-32) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g41" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+32) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g42" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-34) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g43" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+34) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g44" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-36) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g45" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+36) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g46" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-38) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g47" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+38) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g50" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-40) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g51" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+40) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g52" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-42) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g53" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+42) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g54" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-44) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g55" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+44) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g56" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-46) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g57" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+46) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g60" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-48) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g61" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+48) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g62" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-50) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g63" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+50) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g64" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-52) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g65" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+52) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g66" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-54) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g67" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+54) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g70" + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-56) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g71" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+56) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g72" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-58) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g73" + foldLeft +"\"><canvas class=\"zine-canvas\" id=\"p" + (s+58) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g74" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-60) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g75" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+60) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g76" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-62) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g77" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+62) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2+1) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g04" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g05" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g06" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g07" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g14" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g15" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g16" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g17" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-9) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+23) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-23) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+21) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-21) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g24" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+19) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g25" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-19) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g26" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+17) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g27" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-17) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+31) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-31) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+29) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-29) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g34" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+27) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g35" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-27) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g36" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+25) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g37" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-25) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g40" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+39) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g41" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-39) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g42" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+37) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g43" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-37) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g44" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+35) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g45" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-35) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g46" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+33) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g47" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-33) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g50" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+47) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g51" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-47) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g52" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+45) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g53" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-45) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g54" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+43) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g55" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-43) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g56" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+41) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g57" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-41) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g60" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+55) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g61" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-55) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g62" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+53) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g63" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-53) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g64" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+51) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g65" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-51) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g66" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+49) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g67" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-49) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g70" + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+63) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g71" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-63) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g72" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+61) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g73" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-61) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g74" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+59) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g75" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-59) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g76" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+57) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g77" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-57) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                        }
                    } else { // 64th double portrait top
                        for(let i = 0; i < pageCount / 128; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 64 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (64*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + ((!flipBackCover && e == pageCount-1) ? rt + foldTop : foldBottom) + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g04" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g05" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g06" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g07" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-14) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g14" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g15" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g16" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g17" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+14) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-16) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-18) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-20) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-22) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g24" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-24) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g25" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-26) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g26" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-28) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g27" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-30) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+16) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+18) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+20) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+22) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g34" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+24) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g35" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+26) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g36" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+28) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g37" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+30) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g40" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-32) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g41" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-34) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g42" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-36) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g43" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-38) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g44" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-40) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g45" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-42) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g46" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-44) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g47" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-46) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g50" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+32) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g51" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+34) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g52" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+36) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g53" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+38) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g54" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+40) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g55" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+42) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g56" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+44) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g57" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+46) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g60" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-48) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g61" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-50) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g62" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-52) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g63" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-54) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g64" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-56) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g65" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-58) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g66" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-60) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g67" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-62) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g70" + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+48) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g71" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+50) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g72" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+52) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g73" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+54) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g74" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+56) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g75" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+58) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g76" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+60) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g77" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+62) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2+1) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g04" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g05" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g06" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g07" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + rt + cutTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g14" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g15" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g16" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g17" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-31) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-29) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-27) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-25) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g24" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-23) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g25" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-21) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g26" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-19) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g27" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-17) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + rt + cutTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+31) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+29) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+27) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+25) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g34" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+23) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g35" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+21) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g36" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+19) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g37" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+17) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g40" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-47) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g41" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-45) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g42" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-43) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g43" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-41) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g44" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-39) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g45" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-37) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g46" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-35) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g47" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-33) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g50" + rt + cutTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+47) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g51" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+45) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g52" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+43) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g53" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+41) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g54" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+39) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g55" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+37) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g56" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+35) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g57" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+33) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g60" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-63) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g61" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-61) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g62" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-59) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g63" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-57) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g64" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-55) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g65" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-53) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g66" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-51) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g67" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-49) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g70" + rt + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+63) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g71" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+61) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g72" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+59) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g73" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+57) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g74" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+55) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g75" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+53) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g76" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+51) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g77" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+49) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";                        
                        }
                    }
                } else { // 64th double landscape
                    setPageOrientation(false);
                    
                    if(spineSide) { // 64th double landscape side
                        for(let i = 0; i < pageCount / 128; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 64 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (64*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g04" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g05" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g06" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g07" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+6) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g14" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g15" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g16" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-14) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g17" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+14) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-16) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+16) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-18) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+18) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g24" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-20) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g25" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+20) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g26" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-22) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g27" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+22) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-24) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+24) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-26) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+26) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g34" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-28) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g35" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+28) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g36" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-30) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g37" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+30) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g40" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-32) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g41" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+32) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g42" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-34) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g43" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+34) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g44" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-36) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g45" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+36) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g46" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-38) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g47" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+38) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g50" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-40) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g51" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+40) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g52" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-42) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g53" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+42) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g54" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-44) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g55" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+44) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g56" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-46) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g57" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+46) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g60" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-48) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g61" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+48) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g62" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-50) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g63" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+50) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g64" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-52) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g65" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+52) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g66" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-54) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g67" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+54) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g70" + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-56) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g71" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+56) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g72" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-58) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g73" + foldLeft +"\"><canvas class=\"zine-canvas\" id=\"p" + (s+58) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g74" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-60) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g75" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+60) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g76" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-62) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g77" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+62) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2+1) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g04" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g05" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g06" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g07" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g14" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g15" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g16" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g17" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-9) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+23) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-23) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+21) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-21) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g24" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+19) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g25" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-19) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g26" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+17) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g27" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-17) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+31) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-31) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+29) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-29) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g34" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+27) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g35" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-27) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g36" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+25) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g37" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-25) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g40" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+39) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g41" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-39) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g42" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+37) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g43" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-37) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g44" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+35) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g45" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-35) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g46" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+33) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g47" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-33) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g50" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+47) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g51" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-47) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g52" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+45) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g53" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-45) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g54" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+43) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g55" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-43) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g56" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+41) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g57" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-41) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g60" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+55) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g61" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-55) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g62" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+53) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g63" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-53) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g64" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+51) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g65" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-51) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g66" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+49) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g67" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-49) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g70" + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+63) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g71" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-63) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g72" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+61) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g73" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-61) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g74" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+59) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g75" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-59) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g76" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+57) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g77" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-57) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";                        
                        }
                    } else { // 64th double landscape top
                        for(let i = 0; i < pageCount / 128; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 64 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (64*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + ((!flipBackCover && e == pageCount-1) ? rt + foldTop : foldBottom) + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g04" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g05" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g06" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g07" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-14) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g14" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g15" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g16" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g17" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+14) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-16) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-18) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-20) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-22) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g24" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-24) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g25" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-26) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g26" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-28) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g27" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-30) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+16) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+18) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+20) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+22) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g34" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+24) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g35" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+26) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g36" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+28) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g37" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+30) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g40" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-32) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g41" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-34) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g42" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-36) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g43" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-38) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g44" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-40) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g45" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-42) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g46" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-44) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g47" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-46) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g50" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+32) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g51" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+34) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g52" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+36) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g53" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+38) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g54" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+40) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g55" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+42) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g56" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+44) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g57" + cutBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+46) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g60" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-48) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g61" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-50) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g62" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-52) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g63" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-54) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g64" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-56) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g65" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-58) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g66" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-60) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g67" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-62) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g70" + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+48) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g71" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+50) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g72" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+52) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g73" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+54) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g74" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+56) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g75" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+58) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g76" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+60) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g77" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+62) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2+1) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g04" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g05" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g06" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g07" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + rt + cutTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g14" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g15" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g16" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g17" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-31) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-29) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-27) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-25) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g24" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-23) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g25" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-21) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g26" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-19) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g27" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-17) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + rt + cutTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+31) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+29) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+27) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+25) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g34" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+23) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g35" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+21) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g36" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+19) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g37" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+17) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g40" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-47) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g41" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-45) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g42" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-43) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g43" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-41) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g44" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-39) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g45" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-37) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g46" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-35) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g47" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-33) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g50" + rt + cutTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+47) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g51" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+45) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g52" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+43) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g53" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+41) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g54" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+39) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g55" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+37) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g56" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+35) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g57" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+33) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g60" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-63) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g61" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-61) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g62" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-59) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g63" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-57) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g64" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-55) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g65" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-53) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g66" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-51) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g67" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-49) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g70" + rt + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+63) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g71" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+61) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g72" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+59) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g73" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+57) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g74" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+55) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g75" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+53) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g76" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+51) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g77" + rt + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+49) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";                        
                        }
                    }
                }
            } else { // 64th single sided
                if(pageCount % 64 != 0) { // round up to nearest 2 sides
                    pageCount += 64-(pageCount%64);
                }
                
                pagesPerSheet = 64;
                if(sheetsPerSig <= 0) {
                    sheetsPerSig = pageCount / pagesPerSheet;
                }
                pagesPerSig = sheetsPerSig * pagesPerSheet;
                
                if(zinePortrait) { // 64th single portrait
                    setPageOrientation(true);
                    
                    if(spineSide) { // 64th single portrait side
                        for(let i = 0; i < pageCount / 64; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 32 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (32*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-31) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+31) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+30) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+29) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g04" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+28) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g05" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+27) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g06" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+26) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g07" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+25) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-30) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-29) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-28) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + foldBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-27) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g14" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+21) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g15" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+22) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g16" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+23) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g17" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+24) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-23) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-24) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-25) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-26) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g24" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+20) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g25" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+19) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g26" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+18) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g27" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+17) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-22) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-21) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-20) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + foldBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-19) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g34" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g35" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+14) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g36" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g37" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+16) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g40" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g41" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-16) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g42" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-17) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g43" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-18) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g44" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g45" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g46" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g47" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+9) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g50" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-14) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g51" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g52" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g53" + foldBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g54" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g55" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g56" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g57" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+8) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g60" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g61" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g62" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g63" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g64" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g65" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g66" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g67" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g70" + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g71" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g72" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g73" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g74" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g75" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g76" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g77" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                        }
                    } else { // 64th single portrait top
                        for(let i = 0; i < pageCount / 64; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 32 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (32*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-14) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g04" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-22) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g05" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-23) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g06" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-30) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g07" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-31) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-16) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g14" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-21) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g15" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-24) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g16" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-29) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g17" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+31) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-17) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g24" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-20) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g25" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-25) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g26" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-28) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g27" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+30) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-18) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g34" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-19) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g35" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-26) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g36" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-27) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g37" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+29) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g40" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g41" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g42" + foldBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g43" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g44" + foldBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g45" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+20) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g46" + foldBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+21) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g47" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+28) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g50" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g51" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g52" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g53" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g54" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+14) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g55" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+19) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g56" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+22) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g57" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+27) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g60" + ((!flipBackCover && e == pageCount-1) ? rt + foldTop : foldBottom) + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g61" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g62" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g63" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g64" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g65" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+18) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g66" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+23) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g67" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+26) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g70" + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g71" + rt + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g72" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g73" + rt + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g74" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+16) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g75" + rt + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+17) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g76" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+24) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g77" + rt + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+25) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                        }
                    }
                } else { // 64th single landscape
                    setPageOrientation(false);
                    
                    if(spineSide) { // 64th single landscape side
                        for(let i = 0; i < pageCount / 64; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 32 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (32*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-31) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+31) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+30) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+29) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g04" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+28) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g05" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+27) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g06" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+26) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g07" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+25) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-30) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-29) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-28) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + foldBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-27) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g14" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+21) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g15" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+22) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g16" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+23) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g17" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+24) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-23) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-24) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-25) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-26) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g24" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+20) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g25" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+19) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g26" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+18) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g27" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+17) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-22) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-21) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-20) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + foldBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-19) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g34" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g35" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+14) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g36" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g37" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+16) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g40" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g41" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-16) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g42" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-17) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g43" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-18) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g44" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g45" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g46" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g47" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+9) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g50" + cutBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-14) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g51" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g52" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g53" + foldBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g54" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g55" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g56" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g57" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+8) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g60" + rt + foldTop + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g61" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g62" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g63" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g64" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g65" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g66" + rt + cutTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g67" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g70" + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g71" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g72" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g73" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g74" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g75" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g76" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g77" + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                        }
                    } else { // 64th single landscape top
                        for(let i = 0; i < pageCount / 64; i++) {
                            var sigCount = Math.floor(i / sheetsPerSig);
                            var s = 32 * (i%sheetsPerSig) + (sigCount * pagesPerSig);
                            var e = ((sigCount+1)*pagesPerSig) - (32*(i%sheetsPerSig)) - 1;
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-sheet " + gridType + marginGuides + "\" id=\"s" + (i*2) + "\">";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g00" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g01" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g02" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-14) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g03" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g04" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-22) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g05" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-23) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g06" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-30) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g07" + rt + foldTop + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-31) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g10" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g11" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g12" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g13" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-16) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g14" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-21) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g15" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-24) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g16" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-29) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g17" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+31) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g20" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g21" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g22" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g23" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-17) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g24" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-20) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g25" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-25) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g26" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-28) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g27" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+30) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g30" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g31" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g32" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g33" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-18) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g34" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-19) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g35" + rt + cutTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-26) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g36" + cutBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-27) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g37" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+29) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g40" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g41" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+4) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g42" + foldBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+5) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g43" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+12) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g44" + foldBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+13) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g45" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+20) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g46" + foldBottom + foldLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+21) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g47" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+28) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g50" + foldBottom + "\"><canvas class=\"zine-canvas\" id=\"p" + (e-1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g51" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+3) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g52" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+6) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g53" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+11) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g54" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+14) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g55" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+19) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g56" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+22) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g57" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+27) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g60" + ((!flipBackCover && e == pageCount-1) ? rt + foldTop : foldBottom) + "\"><canvas class=\"zine-canvas\" id=\"p" + (e) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g61" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+2) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g62" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+7) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g63" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+10) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g64" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+15) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g65" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+18) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g66" + foldBottom + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+23) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g67" + rt + foldTop + cutRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+26) + "\"></canvas></section>";
                            
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g70" + "\"><canvas class=\"zine-canvas\" id=\"p" + (s) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g71" + rt + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+1) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g72" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+8) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g73" + rt + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+9) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g74" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+16) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g75" + rt + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+17) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g76" + cutLeft + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+24) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "<section class=\"zine-page g77" + rt + foldRight + "\"><canvas class=\"zine-canvas\" id=\"p" + (s+25) + "\"></canvas></section>";
                            sheetsHTML = sheetsHTML + "</section>";
                        }
                    }
                }
            }
        }
        
        document.getElementById("zine").innerHTML = sheetsHTML;
    }
    
    function setPageOrientation(prt) {
        //document.getElementById("page-orient-style").innerHTML = "@media print { @page { size: " + aspectWidth + pgunit + " " + aspectHeight + pgunit + "; } }";
        //document.getElementById("page-orient-style").innerHTML = "@media print { @page { size: " + sheetWidth + "px " + sheetHeight + "px; } }";
        
        if(prt) {
            document.getElementById("page-orient-style").innerHTML = "@media print { @page { size: portrait; } }";
        } else {
            document.getElementById("page-orient-style").innerHTML = "@media print { @page { size: landscape; } }";
        }
        
        /*if(prt) {
            document.getElementById("page-orient-style").innerHTML = "@media print { @page { size: " + sheetWidth + "px " + sheetHeight + "px; } }";
        } else {
            document.getElementById("page-orient-style").innerHTML = "@media print { @page { size: " + sheetHeight + "px " + sheetWidth + " px; } }";
        }*/
    }
            
    
    document.getElementById("selector").addEventListener("change", refreshSpecs, false);
    refreshSpecs();
</script>
</html>
